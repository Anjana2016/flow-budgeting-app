<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Flow - Guilt-Free Spending Made Simple</title>

    <style>
        /* ===== CSS CUSTOM PROPERTIES ===== */
        :root {
            /* Core Brand Colors */
            --primary-bg: #0a0a0f;
            --secondary-bg: #1a1a2e;
            --glass-bg: rgba(26, 26, 46, 0.6);
            --glass-border: rgba(255, 255, 255, 0.06);
            
            /* Text Colors */
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-muted: rgba(255, 255, 255, 0.5);
            
            /* Accent Colors */
            --accent-green: #10b981;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            
            /* Trust & Credibility Colors */
            --trust-blue: #1e40af;
            --trust-green: #059669;
            
            /* Typography */
            --font-xs: 11px;
            --font-sm: 13px;
            --font-base: 15px;
            --font-lg: 17px;
            --font-xl: 20px;
            --font-2xl: 24px;
            --font-3xl: 30px;
            
            /* Animation */
            --animation-timing: cubic-bezier(0.4, 0, 0.2, 1);
            --duration-fast: 0.15s;
            --duration-standard: 0.3s;
            --duration-slow: 0.8s;
        }

        /* ===== BASE RESET & TYPOGRAPHY ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== MAIN CONTAINER ===== */
        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        .welcome-content {
            text-align: center;
            max-width: 400px;
            padding: 40px 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        /* ===== ONBOARDING OVERLAY SYSTEM ===== */
        .onboarding-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s var(--animation-timing);
            overflow: hidden; /* Prevent outer scrolling */
        }

        .onboarding-overlay:not(.hidden) {
            opacity: 1;
            visibility: visible;
        }

        .onboarding-container {
            width: 100%;
            max-width: 400px;
            position: relative;
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px 30px 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            height: 90vh;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* Progress System */
        .onboarding-progress {
            position: absolute;
            top: -50px;
            left: 0;
            right: 0;
            text-align: center;
        }

        .progress-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            border-radius: 3px;
            transition: width 1s var(--animation-timing);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ===== ONBOARDING STEPS ===== */
        .onboarding-step {
            display: none;
            text-align: center;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transition: all 0.6s var(--animation-timing);
            /* Removed max-height and overflow-y to prevent double scrollbars */
        }

        .onboarding-step.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            display: block;
        }

        .step-icon {
            font-size: 48px;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .step-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .step-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-weight: 500;
        }

        .step-description {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 24px;
        }

        /* ===== BRAND & LOGO SYSTEM ===== */
        .brand-header {
            margin-bottom: 32px;
            text-align: center;
        }

        .brand-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 16px;
            position: relative;
            animation: brandPulse 4s ease-in-out infinite;
        }

        .flow-logo {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 24px;
            overflow: hidden;
            background: linear-gradient(135deg, #0F0F1A 0%, #1a1a2e 100%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flow-logo::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue), var(--accent-purple));
            border-radius: 26px;
            z-index: -1;
            animation: logoGlow 3s ease-in-out infinite;
        }

        .flow-f {
            font-size: 36px;
            font-weight: 900;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-blue) 50%, var(--accent-purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            letter-spacing: -2px;
        }

        .flow-streams {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        .stream {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, transparent, var(--accent-green), transparent);
            border-radius: 1px;
            opacity: 0.6;
            animation: flowStream 2.5s ease-in-out infinite;
        }

        .stream:nth-child(1) {
            left: 20%;
            animation-delay: 0s;
        }

        .stream:nth-child(2) {
            left: 40%;
            animation-delay: 0.5s;
        }

        .stream:nth-child(3) {
            left: 60%;
            animation-delay: 1s;
        }

        .stream:nth-child(4) {
            left: 80%;
            animation-delay: 1.5s;
        }

        @keyframes brandPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes logoGlow {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }

        @keyframes flowStream {
            0% { 
                transform: translateY(-10px); 
                opacity: 0; 
                background: linear-gradient(to bottom, transparent, var(--accent-green), transparent);
            }
            25% { 
                opacity: 0.8; 
                background: linear-gradient(to bottom, transparent, var(--accent-blue), transparent);
            }
            50% { 
                transform: translateY(15px); 
                opacity: 0.6; 
                background: linear-gradient(to bottom, transparent, var(--accent-purple), transparent);
            }
            75% { 
                opacity: 0.4; 
                background: linear-gradient(to bottom, transparent, var(--accent-green), transparent);
            }
            100% { 
                transform: translateY(40px); 
                opacity: 0; 
            }
        }

        .brand-name {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .brand-tagline {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* ===== TRUST & CREDIBILITY ELEMENTS ===== */
        .trust-badges {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 24px 0;
        }

        .trust-badge {
            background: rgba(30, 64, 175, 0.1);
            border: 1px solid rgba(30, 64, 175, 0.3);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .trust-icon {
            font-size: 16px;
            color: var(--trust-blue);
        }

        .privacy-section {
            background: rgba(5, 150, 105, 0.1);
            border: 1px solid rgba(5, 150, 105, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin: 24px 0;
            text-align: left;
        }

        .privacy-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--trust-green);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .privacy-points {
            list-style: none;
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .privacy-points li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .privacy-points li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--trust-green);
            font-weight: 600;
        }

        .team-section {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin: 24px 0;
            text-align: left;
        }

        .team-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-purple);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .team-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* ===== CALCULATION TRANSPARENCY & APP CLARITY ===== */
        .calculation-explainer {
            text-align: left;
        }

        .app-clarity-section {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .app-clarity-section h3 {
            color: var(--accent-blue);
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .app-clarity-section p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        .demo-calculation {
            margin-bottom: 24px;
        }

        .demo-calculation h4 {
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            text-align: center;
        }

        .calc-demo-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: relative;
        }

        .calc-step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            animation: slideInSequence 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .calc-step:nth-child(1) { animation-delay: 0.2s; }
        .calc-step:nth-child(3) { animation-delay: 0.4s; }
        .calc-step:nth-child(5) { animation-delay: 0.6s; }
        .calc-step:nth-child(7) { animation-delay: 0.8s; }

        @keyframes slideInSequence {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .calc-step-number {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 12px;
            flex-shrink: 0;
        }

        .calc-step-content {
            flex: 1;
        }

        .calc-step-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .calc-step-amount {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .calc-step-amount.remaining {
            color: var(--accent-blue);
        }

        .calc-step-icon {
            font-size: 20px;
            opacity: 0.7;
        }

        .calc-breakdown {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .breakdown-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .breakdown-row.secure {
            background: rgba(239, 68, 68, 0.1);
            color: var(--text-primary);
        }

        .breakdown-row.save {
            background: rgba(139, 92, 246, 0.1);
            color: var(--text-primary);
        }

        .calc-formula {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .calc-rounding {
            font-size: 12px;
            color: var(--accent-green);
            font-weight: 600;
        }

        .calc-arrow {
            text-align: center;
            font-size: 20px;
            color: var(--accent-green);
            opacity: 0;
            animation: fadeInArrow 0.3s ease-out forwards;
        }

        .calc-arrow:nth-of-type(2) { animation-delay: 0.3s; }
        .calc-arrow:nth-of-type(4) { animation-delay: 0.5s; }
        .calc-arrow:nth-of-type(6) { animation-delay: 0.7s; }

        @keyframes fadeInArrow {
            to { opacity: 0.6; }
        }

        .calc-result {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-top: 12px;
            animation: slideInSequence 0.6s ease-out forwards;
            animation-delay: 1s;
            opacity: 0;
            transform: translateY(20px);
        }

        .result-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .result-amount {
            font-size: 32px;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
        }

        .result-description {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
        }

        .flow-benefits {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .benefit-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
        }

        .benefit-icon {
            font-size: 20px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .benefit-item strong {
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            display: block;
            margin-bottom: 4px;
        }

        .benefit-item p {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.4;
            margin: 0;
        }

        /* ===== CALCULATION DETAILS MODAL ===== */
        .calculation-details-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 3000;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
            z-index: 2999;
        }

        .calculation-details-modal .modal-header {
            padding: 20px 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
            margin-bottom: 20px;
        }

        .calculation-details-modal .modal-header h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 700;
            margin: 0;
        }

        .calculation-details-modal .modal-header button {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .calculation-details-modal .modal-header button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .calculation-details-modal .modal-content {
            padding: 0 20px 20px;
        }

        .detail-section {
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-section h4 {
            color: var(--accent-blue);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 12px 0;
        }

        .detail-section p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
            margin: 0 0 8px 0;
        }

        .detail-section p:last-child {
            margin-bottom: 0;
        }

        .tip-box {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            padding: 16px;
        }

        .tip-box h4 {
            color: var(--accent-green);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 12px 0;
        }

        .tip-box ul {
            margin: 0;
            padding-left: 16px;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }

        .tip-box li {
            margin-bottom: 6px;
        }

        .tip-box li:last-child {
            margin-bottom: 0;
        }

        /* ===== CALL-TO-ACTION BUTTONS ===== */
        .onboarding-cta {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border: none;
            border-radius: 16px;
            padding: 16px 24px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--animation-timing);
            margin-bottom: 12px;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .onboarding-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.4);
        }

        .onboarding-cta:active {
            transform: translateY(0);
        }

        .secondary-cta {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 14px 24px;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s var(--animation-timing);
            margin-bottom: 12px;
        }

        .secondary-cta:hover {
            background: rgba(255, 255, 255, 0.12);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .skip-option {
            margin-top: 20px;
            text-align: center;
        }

        .skip-link {
            color: var(--text-muted);
            font-size: 13px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .skip-link:hover {
            color: var(--text-secondary);
        }

        /* ===== INTERACTIVE INCOME INPUT ===== */
        .income-input-section {
            margin: 24px 0;
            text-align: center;
        }

        .income-label {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .income-input-container {
            position: relative;
            display: inline-block;
            margin-bottom: 16px;
        }

        .income-input {
            font-size: 32px;
            font-weight: 800;
            background: transparent;
            border: none;
            color: var(--accent-green);
            text-align: center;
            width: 200px;
            outline: none;
            border-bottom: 3px solid var(--accent-green);
            padding: 8px 0;
            transition: all 0.3s ease;
        }

        .income-input:focus {
            border-bottom-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .currency-symbol {
            position: absolute;
            left: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .live-calculation {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-top: 16px;
        }

        .daily-flow-preview {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-green);
            margin-bottom: 8px;
        }

        .calculation-breakdown {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* ===== ALLOCATION SLIDERS ===== */
        .allocation-section {
            margin: 24px 0;
            text-align: left;
        }

        .allocation-item {
            margin-bottom: 24px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .allocation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .allocation-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .allocation-percentage {
            font-size: 18px;
            font-weight: 700;
        }

        .allocation-slider {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            margin: 16px 0;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
        }

        .allocation-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent-green);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3);
        }

        .allocation-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--accent-green);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3);
        }

        .allocation-amount {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Color variations for different categories */
        .allocation-item.secure .allocation-slider::-webkit-slider-thumb,
        .allocation-item.secure .allocation-slider::-moz-range-thumb {
            background: var(--accent-red);
            box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
        }

        .allocation-item.save .allocation-slider::-webkit-slider-thumb,
        .allocation-item.save .allocation-slider::-moz-range-thumb {
            background: var(--accent-purple);
            box-shadow: 0 2px 6px rgba(139, 92, 246, 0.3);
        }

        /* ===== SUMMARY & RESULTS ===== */
        .summary-section {
            text-align: center;
            padding: 24px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            margin: 24px 0;
        }

        .summary-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .summary-daily-flow {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .summary-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .summary-breakdown {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }

        .summary-item {
            text-align: center;
            padding: 16px 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }

        .summary-item-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .summary-item-amount {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        /* ===== FEATURE OVERVIEW ===== */
        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 24px 0;
            text-align: left;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .feature-icon.daily-flow {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-green);
        }

        .feature-icon.budget-health {
            background: rgba(59, 130, 246, 0.2);
            color: var(--accent-blue);
        }

        .feature-icon.journey {
            background: rgba(139, 92, 246, 0.2);
            color: var(--accent-purple);
        }

        .feature-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .feature-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .achievement-section {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .achievement-section::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--accent-purple), var(--accent-pink), var(--accent-purple));
            border-radius: 18px;
            z-index: -1;
            animation: achievementGlow 3s ease-in-out infinite;
        }

        @keyframes achievementGlow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .achievement-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--accent-purple);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .achievement-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* ===== APP FOOTER ===== */
        .app-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border-top: 1px solid var(--glass-border);
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            z-index: 500;
        }

        .version-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-muted);
        }

        .footer-links {
            display: flex;
            gap: 16px;
        }

        .footer-link {
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: var(--text-secondary);
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 480px) {
            .onboarding-container {
                padding: 30px 20px 20px;
                max-height: 95vh;
            }

            .step-title {
                font-size: 20px;
            }

            .income-input {
                font-size: 28px;
                width: 180px;
            }

            .summary-breakdown {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .trust-badges {
                grid-template-columns: 1fr;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .hidden {
            opacity: 0 !important;
            visibility: hidden !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <!-- Main Welcome Screen -->
    <div class="main-container" id="mainContainer">
        <div class="welcome-content">
            <h1 style="font-size: 32px; font-weight: 800; margin-bottom: 16px; background: linear-gradient(135deg, var(--accent-green), var(--accent-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                Welcome to Flow
            </h1>
            <p style="font-size: 16px; color: var(--text-secondary); margin-bottom: 24px; line-height: 1.6;">
                Your personalized Flow is ready!
            </p>
            <button onclick="showOnboarding()" style="margin-top: 20px; padding: 12px 24px; background: var(--accent-green); border: none; border-radius: 12px; color: white; cursor: pointer;">
                Experience Full Onboarding Flow
            </button>
        </div>
    </div>

    <!-- Comprehensive Onboarding Flow -->
    <div class="onboarding-overlay hidden" id="onboardingOverlay">
        <div class="onboarding-container">
            <div class="onboarding-progress">
                <div class="progress-text">Building trust & credibility</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 12.5%;"></div>
                </div>
            </div>

            <!-- Step 1: Brand Introduction & Trust Building -->
            <div class="onboarding-step active" id="onboardingStep1">
                <div class="brand-header">
                    <div class="brand-logo">
                        <div class="flow-logo">
                            <div class="flow-f">F</div>
                            <div class="flow-streams">
                                <div class="stream"></div>
                                <div class="stream"></div>
                                <div class="stream"></div>
                                <div class="stream"></div>
                            </div>
                        </div>
                    </div>
                    <div class="brand-name">Flow</div>
                    <div class="brand-tagline">Guilt-Free Spending Made Simple</div>
                </div>

                <div class="trust-badges">
                    <div class="trust-badge">
                        <span class="trust-icon">üîí</span>
                        <span>Bank-grade security</span>
                    </div>
                    <div class="trust-badge">
                        <span class="trust-icon">üì±</span>
                        <span>Local data only</span>
                    </div>
                    <div class="trust-badge">
                        <span class="trust-icon">üöÄ</span>
                        <span>Production ready</span>
                    </div>
                    <div class="trust-badge">
                        <span class="trust-icon">‚ö°</span>
                        <span>Zero tracking</span>
                    </div>
                </div>

                <p class="step-description">
                    Flow is a professional budgeting app designed by financial planning experts. We believe spending should feel guilt-free when it's planned properly.
                </p>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    Start Your Setup ‚ú®
                </button>
                
                <div class="skip-option">
                    <a href="#" class="skip-link" onclick="skipOnboarding()">Continue without setup</a>
                </div>
            </div>

            <!-- Step 2: Privacy & Security Assurance -->
            <div class="onboarding-step" id="onboardingStep2">
                <div class="step-icon">üîê</div>
                <h2 class="step-title">Your Privacy Matters</h2>
                <p class="step-subtitle">Complete transparency about your data</p>

                <div class="privacy-section">
                    <div class="privacy-title">
                        <span>üõ°Ô∏è</span>
                        Your Data, Your Control
                    </div>
                    <ul class="privacy-points">
                        <li>All data stays on your device - never uploaded</li>
                        <li>No accounts, logins, or personal info required</li>
                        <li>Export your data anytime (JSON format)</li>
                        <li>Zero tracking, analytics, or third-party services</li>
                        <li>Works completely offline after first load</li>
                    </ul>
                </div>

                <div class="team-section">
                    <div class="team-title">
                        <span>üë•</span>
                        Built by Financial Experts
                    </div>
                    <div class="team-description">
                        Created by certified financial planners and behavioral economists, Flow uses proven psychological principles to make budgeting feel natural and stress-free.
                    </div>
                </div>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    Perfect! Let's Continue üéØ
                </button>
                
                <button class="secondary-cta" onclick="showDataExportInfo()">
                    Show Me Data Export
                </button>
            </div>

            <!-- Step 3: Concept Introduction -->
            <div class="onboarding-step" id="onboardingStep3">
                <div class="step-icon">üí°</div>
                <h2 class="step-title">The Flow Philosophy</h2>
                <p class="step-subtitle">3 simple buckets for worry-free money management</p>

                <div style="display: grid; grid-template-columns: 1fr; gap: 16px; margin: 24px 0; text-align: left;">
                    <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 12px; padding: 16px;">
                        <div style="color: var(--accent-blue); font-weight: 600; margin-bottom: 8px;">üíô SECURE (55%)</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Bills, rent, groceries - the essentials you can't skip</div>
                    </div>
                    
                    <div style="background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 12px; padding: 16px;">
                        <div style="color: var(--accent-purple); font-weight: 600; margin-bottom: 8px;">üíú SAVE (5-25%)</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Future goals, emergency fund, long-term dreams</div>
                    </div>
                    
                    <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 16px;">
                        <div style="color: var(--accent-green); font-weight: 600; margin-bottom: 8px;">üíö SPEND (Remaining)</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Coffee, entertainment, spontaneous fun - completely guilt-free!</div>
                    </div>
                </div>

                <p class="step-description">
                    Your "Daily Flow" = SPEND amount √∑ 30 days. When you stay within this number, you're automatically saving and covering essentials!
                </p>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    I Get It! Show Me How üßÆ
                </button>
            </div>

            <!-- Step 4: Calculation Transparency & App Clarity -->
            <div class="onboarding-step" id="onboardingStep4">
                <div class="step-icon">üìä</div>
                <h2 class="step-title">How Flow Works</h2>
                <p class="step-subtitle">The math behind your guilt-free spending</p>

                <div class="calculation-explainer">
                    <div class="app-clarity-section">
                        <h3>üí° What makes Flow different?</h3>
                        <p>Most budgeting apps overwhelm you with categories and complex tracking. Flow uses psychology and simple math to give you one clear number: <strong>your daily spending amount</strong>.</p>
                    </div>
                    
                    <div class="demo-calculation">
                        <h4>Here's how we calculate your Daily Flow:</h4>
                        <div class="calc-demo-container">
                            <div class="calc-step" id="calcDemo1">
                                <div class="calc-step-number">1</div>
                                <div class="calc-step-content">
                                    <div class="calc-step-title">Your Monthly Income</div>
                                    <div class="calc-step-amount">$3,200</div>
                                </div>
                                <div class="calc-step-icon">üí∞</div>
                            </div>
                            
                            <div class="calc-arrow">‚Üì</div>
                            
                            <div class="calc-step" id="calcDemo2">
                                <div class="calc-step-number">2</div>
                                <div class="calc-step-content">
                                    <div class="calc-step-title">Smart Allocations</div>
                                    <div class="calc-breakdown">
                                        <div class="breakdown-row secure">
                                            <span>üè† SECURE (55%)</span>
                                            <span>$1,760</span>
                                        </div>
                                        <div class="breakdown-row save">
                                            <span>üíú SAVE (10%)</span>
                                            <span>$320</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="calc-step-icon">üéØ</div>
                            </div>
                            
                            <div class="calc-arrow">‚Üì</div>
                            
                            <div class="calc-step" id="calcDemo3">
                                <div class="calc-step-number">3</div>
                                <div class="calc-step-content">
                                    <div class="calc-step-title">Remaining for SPEND</div>
                                    <div class="calc-step-amount remaining">$1,120</div>
                                </div>
                                <div class="calc-step-icon">üíö</div>
                            </div>
                            
                            <div class="calc-arrow">‚Üì</div>
                            
                            <div class="calc-step" id="calcDemo4">
                                <div class="calc-step-number">4</div>
                                <div class="calc-step-content">
                                    <div class="calc-step-title">Daily Flow Formula</div>
                                    <div class="calc-formula">$1,120 √∑ 30 days = $37.33</div>
                                    <div class="calc-rounding">Rounded to $35/day</div>
                                </div>
                                <div class="calc-step-icon">üßÆ</div>
                            </div>
                            
                            <div class="calc-result">
                                <div class="result-label">Your Daily Flow</div>
                                <div class="result-amount">$35</div>
                                <div class="result-description">Spend this amount daily = automatic savings + covered essentials!</div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-benefits">
                        <div class="benefit-item">
                            <span class="benefit-icon">üéØ</span>
                            <div>
                                <strong>One Simple Number</strong>
                                <p>No complex categories - just "Can I afford this today?"</p>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <span class="benefit-icon">üíö</span>
                            <div>
                                <strong>Guilt-Free Spending</strong>
                                <p>Stay within your Daily Flow = you're automatically saving and covering bills</p>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <span class="benefit-icon">üß†</span>
                            <div>
                                <strong>Behavioral Psychology</strong>
                                <p>Designed by financial experts to reduce money anxiety</p>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    I Understand How It Works! üéØ
                </button>
                
                <button class="secondary-cta" onclick="showCalculationDetails()">
                    Show Advanced Math Details
                </button>
            </div>

            <!-- Step 5: Interactive Income Setup -->
            <div class="onboarding-step" id="onboardingStep5">
                <div class="step-icon">üí∞</div>
                <h2 class="step-title">Your Monthly Income</h2>
                <p class="step-subtitle">Let's calculate your personal Daily Flow</p>

                <div class="income-input-section">
                    <div class="income-label">What's your monthly income?</div>
                    <div class="income-input-container">
                        <span class="currency-symbol">$</span>
                        <input 
                            type="number" 
                            class="income-input" 
                            id="incomeInput" 
                            value="3200" 
                            min="500" 
                            max="50000" 
                            step="100"
                            oninput="updateLiveCalculation()"
                            placeholder="3200"
                        >
                    </div>
                    
                    <div class="live-calculation" id="liveCalculation">
                        <div class="daily-flow-preview" id="dailyFlowPreview">$35/day</div>
                        <div class="calculation-breakdown" id="calculationBreakdown">
                            Based on 10% savings and 55% essentials<br>
                            Your guilt-free daily spending amount
                        </div>
                    </div>
                </div>

                <p class="step-description">
                    This includes your salary, freelance income, or any other regular monthly income. We use this to calculate your perfect Daily Flow amount.
                </p>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    Perfect! What's Next? ‚öôÔ∏è
                </button>
            </div>

            <!-- Step 6: Interactive Allocation Adjustment -->
            <div class="onboarding-step" id="onboardingStep6">
                <div class="step-icon">‚öôÔ∏è</div>
                <h2 class="step-title">Fine-Tune Your Flow</h2>
                <p class="step-subtitle">Adjust the percentages to match your lifestyle</p>

                <div class="allocation-section">
                    <div class="allocation-item secure">
                        <div class="allocation-header">
                            <div class="allocation-label">
                                <span>üè†</span>
                                <span>SECURE - Essential expenses</span>
                            </div>
                            <div class="allocation-percentage" id="securePercent">55%</div>
                        </div>
                        <input 
                            type="range" 
                            class="allocation-slider" 
                            id="secureSlider" 
                            min="40" 
                            max="70" 
                            value="55"
                            oninput="updateAllocations()"
                        >
                        <div class="allocation-amount" id="secureAmount">$1,760 per month</div>
                    </div>

                    <div class="allocation-item save">
                        <div class="allocation-header">
                            <div class="allocation-label">
                                <span>üíú</span>
                                <span>SAVE - Future goals</span>
                            </div>
                            <div class="allocation-percentage" id="savePercent">10%</div>
                        </div>
                        <input 
                            type="range" 
                            class="allocation-slider" 
                            id="saveSlider" 
                            min="5" 
                            max="30" 
                            value="10"
                            oninput="updateAllocations()"
                        >
                        <div class="allocation-amount" id="saveAmount">$320 per month</div>
                    </div>

                    <div class="allocation-item spend">
                        <div class="allocation-header">
                            <div class="allocation-label">
                                <span>üíö</span>
                                <span>SPEND - Guilt-free fun</span>
                            </div>
                            <div class="allocation-percentage" id="spendPercent">35%</div>
                        </div>
                        <div style="height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 3px; margin: 16px 0; position: relative;">
                            <div style="height: 100%; background: var(--accent-green); border-radius: 3px; width: 35%; transition: width 0.3s ease;" id="spendBar"></div>
                        </div>
                        <div class="allocation-amount" id="spendAmount">$1,120 per month = <span id="dailyAmount">$35/day</span></div>
                    </div>
                </div>

                <p class="step-description">
                    Drag the sliders to find your sweet spot. Your SPEND percentage automatically adjusts to ensure everything adds up to 100%.
                </p>

                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    Looks Perfect! üéØ
                </button>
            </div>

            <!-- Step 7: Personalized Summary -->
            <div class="onboarding-step" id="onboardingStep7">
                <div class="step-icon">üéâ</div>
                <h2 class="step-title">Your Flow is Ready!</h2>
                <p class="step-subtitle">Here's your personalized budget system</p>

                <div class="summary-section">
                    <div class="summary-title">Your Daily Flow</div>
                    <div class="summary-daily-flow" id="summaryDailyFlow">$35</div>
                    <div class="summary-description" id="summaryDescription">
                        Spend up to this amount each day and you'll automatically save $320 monthly while covering all your essentials!
                    </div>

                    <div class="summary-breakdown">
                        <div class="summary-item">
                            <div class="summary-item-label">SECURE</div>
                            <div class="summary-item-amount" id="summarySecure">$1,760</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-item-label">SAVE</div>
                            <div class="summary-item-amount" id="summarySave">$320</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-item-label">SPEND</div>
                            <div class="summary-item-amount" id="summarySpend">$1,120</div>
                        </div>
                    </div>
                </div>

                <div class="achievement-section">
                    <div class="achievement-title">
                        <span>üèÜ</span>
                        Achievement Unlocked!
                    </div>
                    <div class="achievement-description">
                        "Setup Master" - You've successfully configured your Flow Budgeting system!
                    </div>
                </div>
                
                <button class="onboarding-cta" onclick="nextOnboardingStep()">
                    Show Me The App! üöÄ
                </button>
                
                <button class="secondary-cta" onclick="exportUserData()">
                    Export My Setup Data
                </button>
            </div>

            <!-- Step 8: Feature Overview -->
            <div class="onboarding-step" id="onboardingStep8">
                <div class="step-icon">üó∫Ô∏è</div>
                <h2 class="step-title">Your Flow App Tour</h2>
                <p class="step-subtitle">Navigate your new financial freedom</p>

                <div class="feature-list">
                    <div class="feature-item">
                        <div class="feature-icon daily-flow">üíö</div>
                        <div>
                            <div class="feature-title">Daily Flow</div>
                            <div class="feature-description">
                                Track your daily spending, see your remaining budget, and add expenses with one tap. Your financial pulse check.
                            </div>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="feature-icon budget-health">üéØ</div>
                        <div>
                            <div class="feature-title">Budget Health</div>
                            <div class="feature-description">
                                Monitor your 3 S's progress, adjust allocations, and understand how your spending impacts your financial goals.
                            </div>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="feature-icon journey">üë§</div>
                        <div>
                            <div class="feature-title">Your Journey</div>
                            <div class="feature-description">
                                View your financial growth over time, celebrate milestones, and see how Flow is building your wealth.
                            </div>
                        </div>
                    </div>
                </div>

                <p class="step-description">
                    Use the bottom navigation to switch between tabs. Start with Daily Flow to track your first guilt-free purchase!
                </p>

                <button class="onboarding-cta" onclick="completeOnboarding()">
                    Start My Journey! üöÄ
                </button>
                
                <button class="secondary-cta" onclick="exportUserData()">
                    Export My Setup Data
                </button>
            </div>
        </div>
    </div>

    <!-- App Footer with Version & Links -->
    <div class="app-footer">
        <div class="version-info">
            <span>Flow v2.1.0</span>
            <span>‚Ä¢</span>
            <span>Production Build</span>
        </div>
        <div class="footer-links">
            <a href="#" class="footer-link" onclick="showPrivacyInfo()">Privacy</a>
            <a href="#" class="footer-link" onclick="showAboutTeam()">About</a>
            <a href="#" class="footer-link" onclick="exportUserData()">Export Data</a>
        </div>
    </div>

    <script>
        // ===== COMPREHENSIVE ONBOARDING SYSTEM ===== 
        let currentOnboardingStep = 1;
        const totalOnboardingSteps = 8;
        
        // User's settings (starts with defaults)
        let userSettings = {
            income: 3200,
            allocations: {
                secure: 55,
                save: 10,
                spend: 35
            },
            onboardingCompleted: false,
            setupTimestamp: null
        };

        function nextOnboardingStep() {
            // Validate current step before proceeding
            if (currentOnboardingStep === 5) {
                const incomeInput = document.getElementById('incomeInput');
                if (!incomeInput) {
                    showToast('Income input not found. Please try again.', 'warning');
                    return;
                }
                
                const income = parseInt(incomeInput.value);
                if (!income || income < 500 || income > 50000) {
                    showToast('Please enter a valid income between $500 and $50,000', 'warning');
                    return;
                }
                userSettings.income = income;
            }

            
            // Hide current step
            document.getElementById(`onboardingStep${currentOnboardingStep}`).classList.remove('active');
            
            // Move to next step
            currentOnboardingStep++;
            
            // Update progress
            updateOnboardingProgress();
            
            // Update summary data if moving to final step
            if (currentOnboardingStep === 7) {
                updateSummaryDisplay();
            }
            
            // Show next step with delay for smooth transition
            setTimeout(() => {
                if (currentOnboardingStep <= totalOnboardingSteps) {
                    document.getElementById(`onboardingStep${currentOnboardingStep}`).classList.add('active');
                }
            }, 300);
            
            // Haptic feedback
            if (navigator.vibrate) {
                navigator.vibrate([10, 100, 10]);
            }
        }

        function updateOnboardingProgress() {
            const progressPercentage = (currentOnboardingStep / totalOnboardingSteps) * 100;
            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
            
            // Update progress text
            const progressText = document.querySelector('.progress-text');
            if (currentOnboardingStep === 1) {
                progressText.textContent = 'Building trust & credibility';
            } else if (currentOnboardingStep === 2) {
                progressText.textContent = 'Privacy & security overview';
            } else if (currentOnboardingStep === 3) {
                progressText.textContent = 'Learning Flow concepts';
            } else if (currentOnboardingStep === 4) {
                progressText.textContent = 'Understanding the calculations';
            } else if (currentOnboardingStep === 5) {
                progressText.textContent = 'Setting up your income';
            } else if (currentOnboardingStep === 6) {
                progressText.textContent = 'Customizing allocations';
            } else if (currentOnboardingStep === 7) {
                progressText.textContent = 'Reviewing your setup';
            } else if (currentOnboardingStep === 8) {
                progressText.textContent = 'Ready to flow!';
            }
        }

        function skipOnboarding() {
            closeOnboarding();
            showToast('Welcome! Your default settings are ready.', 'success');
        }

        function showOnboarding() {
            // Reset to first step
            currentOnboardingStep = 1;
            document.querySelectorAll('.onboarding-step').forEach(step => step.classList.remove('active'));
            document.getElementById('onboardingStep1').classList.add('active');
            updateOnboardingProgress();
            
            // Reset user settings to defaults
            userSettings = {
                income: 3200,
                allocations: {
                    secure: 55,
                    save: 10,
                    spend: 35
                },
                onboardingCompleted: false,
                setupTimestamp: null
            };
            
            // Reset form values (with null checks)
            const incomeInput = document.getElementById('incomeInput');
            const secureSlider = document.getElementById('secureSlider');
            const saveSlider = document.getElementById('saveSlider');
            
            if (incomeInput) incomeInput.value = '3200';
            if (secureSlider) secureSlider.value = '55';
            if (saveSlider) saveSlider.value = '10';
            
            // Update initial displays (these functions now have null checks)
            updateLiveCalculation();
            updateAllocations();
            
            // Show overlay
            document.getElementById('onboardingOverlay').classList.remove('hidden');
        }

        function showCalculationDetails() {
            const detailsModal = `
                <div class="calculation-details-modal">
                    <div class="modal-header">
                        <h3>üßÆ Advanced Calculation Details</h3>
                        <button onclick="closeCalculationDetails()">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="detail-section">
                            <h4>üéØ Why These Percentages?</h4>
                            <p><strong>SECURE (55%):</strong> Based on average American spending data, most people spend 50-60% on essentials like housing, utilities, groceries, and transportation.</p>
                            <p><strong>SAVE (Variable):</strong> Financial experts recommend 10-20% savings rate, but we start beginners at 5% to build the habit.</p>
                            <p><strong>SPEND (Remainder):</strong> What's left is truly yours to spend guilt-free!</p>
                        </div>
                        
                        <div class="detail-section">
                            <h4>üîÑ Smart Rounding System</h4>
                            <p><strong>Why round to $5?</strong> Psychological research shows people make better spending decisions with round numbers. $35 feels more manageable than $37.33.</p>
                            <p><strong>What happens to the difference?</strong> Any rounding creates a small buffer that helps you stay under budget naturally.</p>
                        </div>
                        
                        <div class="detail-section">
                            <h4>üìÖ 30-Day Calculation</h4>
                            <p><strong>Why 30 days?</strong> Most bills and income are monthly, so we keep it simple. In shorter months, you get a small bonus. In longer months, you have a tiny buffer.</p>
                            <p><strong>Weekend vs Weekday?</strong> We don't differentiate - some people spend more on weekends, others during the week. It balances out.</p>
                        </div>
                        
                        <div class="tip-box">
                            <h4>üí° Pro Tips</h4>
                            <ul>
                                <li>Underspend a few days? Great! You can splurge later in the month.</li>
                                <li>Overspend one day? No problem! Just aim lower the next few days.</li>
                                <li>The goal isn't perfection - it's building better spending awareness.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-overlay" onclick="closeCalculationDetails()"></div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', detailsModal);
            showToast('üìä Advanced calculation details opened', 'info');
        }

        function closeCalculationDetails() {
            const modal = document.querySelector('.calculation-details-modal');
            const overlay = document.querySelector('.modal-overlay');
            if (modal) modal.remove();
            if (overlay) overlay.remove();
        }

        // ===== TRUST & CREDIBILITY FUNCTIONS =====
        function showDataExportInfo() {
            const exportData = {
                userSettings: userSettings,
                exportDate: new Date().toISOString(),
                appVersion: "2.1.0",
                dataFormat: "JSON"
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'flow-settings-export.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('üìÑ Settings exported! This is how your data looks.', 'success');
        }

        function exportUserData() {
            showDataExportInfo();
        }

        function showPrivacyInfo() {
            alert('Privacy Policy:\n\n‚Ä¢ All data stays on your device\n‚Ä¢ No personal info collected\n‚Ä¢ No third-party tracking\n‚Ä¢ Export data anytime\n‚Ä¢ Delete by clearing browser data\n\nFlow respects your privacy completely.');
        }

        function showAboutTeam() {
            alert('About Flow:\n\nCreated by certified financial planners and behavioral economists.\n\nOur mission: Transform financial anxiety into confidence through psychology-driven budgeting.\n\nVersion 2.1.0 - Production Build');
        }

        // ===== INTERACTIVE INPUT FUNCTIONS =====
        function updateLiveCalculation() {
            const incomeInput = document.getElementById('incomeInput');
            
            // Early return if income input doesn't exist yet
            if (!incomeInput) {
                return;
            }
            
            const income = parseInt(incomeInput.value) || 3200;
            const secure = Math.round(income * 0.55);
            const save = Math.round(income * 0.10);
            const spend = income - secure - save;
            const dailyFlow = Math.round(spend / 30 / 5) * 5; // Round to nearest $5

            const dailyFlowPreview = document.getElementById('dailyFlowPreview');
            const calculationBreakdown = document.getElementById('calculationBreakdown');
            
            if (dailyFlowPreview) {
                dailyFlowPreview.textContent = `${dailyFlow}/day`;
            }
            
            if (calculationBreakdown) {
                calculationBreakdown.innerHTML = 
                    `SECURE: ${secure} ‚Ä¢ SAVE: ${save} ‚Ä¢ SPEND: ${spend}<br>Your guilt-free daily spending amount`;
            }
        }

        function updateAllocations() {
            const incomeInput = document.getElementById('incomeInput');
            const secureSlider = document.getElementById('secureSlider');
            const saveSlider = document.getElementById('saveSlider');
            
            // Early return if elements don't exist yet (not on the right step)
            if (!incomeInput || !secureSlider || !saveSlider) {
                return;
            }
            
            const income = parseInt(incomeInput.value) || 3200;
            const securePercent = parseInt(secureSlider.value);
            const savePercent = parseInt(saveSlider.value);
            const spendPercent = 100 - securePercent - savePercent;

            // Update displayed percentages (with null checks)
            const securePercentEl = document.getElementById('securePercent');
            const savePercentEl = document.getElementById('savePercent');
            const spendPercentEl = document.getElementById('spendPercent');
            
            if (securePercentEl) securePercentEl.textContent = `${securePercent}%`;
            if (savePercentEl) savePercentEl.textContent = `${savePercent}%`;
            if (spendPercentEl) spendPercentEl.textContent = `${spendPercent}%`;

            // Calculate amounts
            const secureAmount = Math.round(income * securePercent / 100);
            const saveAmount = Math.round(income * savePercent / 100);
            const spendAmount = income - secureAmount - saveAmount;
            const dailyAmount = Math.round(spendAmount / 30 / 5) * 5;

            // Update displayed amounts (with null checks)
            const secureAmountEl = document.getElementById('secureAmount');
            const saveAmountEl = document.getElementById('saveAmount');
            const spendAmountEl = document.getElementById('spendAmount');
            const dailyAmountEl = document.getElementById('dailyAmount');
            const spendBarEl = document.getElementById('spendBar');
            
            if (secureAmountEl) secureAmountEl.textContent = `${secureAmount} per month`;
            if (saveAmountEl) saveAmountEl.textContent = `${saveAmount} per month`;
            if (spendAmountEl) spendAmountEl.textContent = `${spendAmount} per month`;
            if (dailyAmountEl) dailyAmountEl.textContent = `${dailyAmount}/day`;
            if (spendBarEl) spendBarEl.style.width = `${spendPercent}%`;

            // Store in user settings
            userSettings.allocations = {
                secure: securePercent,
                save: savePercent,
                spend: spendPercent
            };
        }

        function updateSummaryDisplay() {
            const income = userSettings.income;
            const secureAmount = Math.round(income * userSettings.allocations.secure / 100);
            const saveAmount = Math.round(income * userSettings.allocations.save / 100);
            const spendAmount = income - secureAmount - saveAmount;
            const dailyFlow = Math.round(spendAmount / 30 / 5) * 5;

            const summaryDailyFlow = document.getElementById('summaryDailyFlow');
            const summaryDescription = document.getElementById('summaryDescription');
            const summarySecure = document.getElementById('summarySecure');
            const summarySave = document.getElementById('summarySave');
            const summarySpend = document.getElementById('summarySpend');

            if (summaryDailyFlow) summaryDailyFlow.textContent = `${dailyFlow}`;
            if (summaryDescription) {
                summaryDescription.textContent = 
                    `Spend up to this amount each day and you'll automatically save ${saveAmount} monthly while covering all your essentials!`;
            }
            if (summarySecure) summarySecure.textContent = `${secureAmount}`;
            if (summarySave) summarySave.textContent = `${saveAmount}`;
            if (summarySpend) summarySpend.textContent = `${spendAmount}`;
        }

        function completeOnboarding() {
            userSettings.onboardingCompleted = true;
            userSettings.setupTimestamp = new Date().toISOString();
            
            // Save to localStorage
            localStorage.setItem('flowUserSettings', JSON.stringify(userSettings));
            
            closeOnboarding();
            showToast('üéâ Welcome to Flow! Your personalized budget is ready.', 'success');
        }

        function closeOnboarding() {
            document.getElementById('onboardingOverlay').classList.add('hidden');
        }

        // ===== UTILITY FUNCTIONS =====
        function showToast(message, type = 'info') {
            // Simple toast notification
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(26, 26, 46, 0.9);
                color: white;
                padding: 12px 20px;
                border-radius: 12px;
                border: 1px solid rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(24px);
                z-index: 5000;
                max-width: 300px;
                font-size: 14px;
                animation: slideInRight 0.3s ease-out;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-in forwards';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved settings if they exist
            const savedSettings = localStorage.getItem('flowUserSettings');
            if (savedSettings) {
                userSettings = JSON.parse(savedSettings);
                if (userSettings.onboardingCompleted) {
                    // Auto-populate form fields with saved data (with null check)
                    const incomeInput = document.getElementById('incomeInput');
                    if (incomeInput) {
                        incomeInput.value = userSettings.income;
                    }
                }
            }
            
            // Initialize live calculation (these functions now have null checks)
            updateLiveCalculation();
            updateAllocations();
        });

        // ===== CSS ANIMATIONS (Injected via JavaScript) =====
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>