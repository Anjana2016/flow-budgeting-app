<!DOCTYPE html>
<!-- saved from url=(0071)file:///Users/anjanasudhakar/Downloads/flow_budget_app_fixed%20(1).html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>💚 Flow Budgeting - Guilt-Free Zone</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Flow Budget">
    <meta name="theme-color" content="#10b981">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 100 100&#39;&gt;&lt;text y=&#39;.9em&#39; font-size=&#39;90&#39;&gt;%F0%9F%92%9A&lt;/text&gt;&lt;/svg&gt;">
    
    <!-- React 18 from CDN -->
    <script crossorigin="" src="./index_files/react.production.min.js"></script>
    <script crossorigin="" src="./index_files/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="./index_files/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="./index_files/tailwind.min.js"></script>
    
    <style>
        /* Custom CSS for animations and special effects */
        @keyframes subtleGradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes floatingPulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 16px 40px rgba(16, 185, 129, 0.4); 
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 20px 50px rgba(16, 185, 129, 0.6); 
            }
        }
        
        @keyframes slideInDown {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeInScale {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes ringPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .animate-in {
            animation-fill-mode: both;
        }
        
        .slide-in-from-bottom-4 {
            animation: slideInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .slide-in-from-top-4 {
            animation: slideInDown 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .slide-in-from-left-4 {
            animation: slideInLeft 0.8s ease-out;
        }
        
        .slide-in-from-right-4 {
            animation: slideInRight 0.8s ease-out;
        }
        
        .fade-in-scale {
            animation: fadeInScale 0.8s ease-out;
        }
        
        /* Mobile optimization */
        @media screen and (max-width: 480px) {
            .container {
                padding: 16px;
            }
        }
        
        /* Touch optimization */
        button, input {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* Prevent zoom on input focus */
        input[type="number"] {
            font-size: 16px;
        }
        
        /* PWA safe areas */
        .container {
            padding-bottom: env(safe-area-inset-bottom);
            padding-top: env(safe-area-inset-top);
        }
        
        /* Custom gradient backgrounds */
        .bg-animated {
            background: linear-gradient(45deg, #0f0f1a, #1a1a2e, #16213e, #1a1a2e);
            background-size: 400% 400%;
            animation: subtleGradientShift 25s ease infinite;
        }
        
        .floating-add {
            animation: floatingPulse 3s ease-in-out infinite;
        }
        
        /* Dual progress ring system */
        .progress-ring-overlay {
            animation: ringPulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        // Initial state with guilt-free focused data structure
        const initialState = {
            user: {
                id: 'user_1',
                name: 'Sarah',
                monthlyIncome: 3200,
                currentPeriod: 'monthly',
                joinDate: new Date('2024-06-01')
            },
            currentMonth: {
                year: 2024,
                month: 6,
                startDate: new Date('2024-06-01'),
                endDate: new Date('2024-06-30'),
                daysTotal: 30,
                daysRemaining: 10
            },
            budget: {
                fixedExpenses: [
                    { id: 1, name: 'Rent', amount: 1200, dueDate: 1, category: 'housing' },
                    { id: 2, name: 'Insurance', amount: 150, dueDate: 15, category: 'insurance' },
                    { id: 3, name: 'Phone', amount: 80, dueDate: 10, category: 'utilities' }
                ],
                allocation: {
                    spend: 0.6,
                    stash: 0.25,
                    save: 0.15
                }
            },
            transactions: [
                { id: 1, amount: 6.50, description: 'Morning Oat Latte', category: 'spend', timestamp: new Date('2024-06-20T08:30:00'), merchantId: 'coffee_shop', guiltFree: true },
                { id: 2, amount: 14.75, description: 'Healthy Lunch Bowl', category: 'spend', timestamp: new Date('2024-06-19T12:15:00'), merchantId: 'lunch_spot', guiltFree: true },
                { id: 3, amount: 4.25, description: 'Friday Ice Cream', category: 'spend', timestamp: new Date('2024-06-19T18:00:00'), merchantId: 'ice_cream', guiltFree: true },
                { id: 4, amount: 8.75, description: 'Afternoon Snack', category: 'spend', timestamp: new Date('2024-06-18T15:30:00'), merchantId: 'snack_bar', guiltFree: true }
            ],
            gamification: {
                currentStreak: 5,
                totalGuiltFreeExpenses: 47,
                achievements: ['5_day_streak', 'guilt_free_week', 'budget_champion'],
                lastCelebration: new Date('2024-06-20T12:15:00')
            }
        };

        function FlowBudgetingApp() {
            const [state, setState] = useState(initialState);
            const [activeTab, setActiveTab] = useState('guilt-free');
            const [showToast, setShowToast] = useState(false);
            const [toastMessage, setToastMessage] = useState('');
            const [customAmount, setCustomAmount] = useState('');

            // Calculate Daily Guilt-Free Amount with proper $5 rounding
            const calculateGuiltFreeFlow = () => {
                const { user, budget, transactions, currentMonth } = state;
                
                const totalFixedExpenses = budget.fixedExpenses.reduce((sum, expense) => sum + expense.amount, 0);
                const availableIncome = user.monthlyIncome - totalFixedExpenses;
                const spendAllocation = availableIncome * budget.allocation.spend;
                const totalSpent = transactions.reduce((sum, tx) => sum + tx.amount, 0);
                const remainingSpendBudget = spendAllocation - totalSpent;
                const rawDailyAmount = remainingSpendBudget / currentMonth.daysRemaining;
                
                // Round to nearest $5 increment
                const dailyGuiltFreeAmount = Math.round(rawDailyAmount / 5) * 5;
                
                const today = new Date().toDateString();
                const todaySpent = transactions
                    .filter(tx => tx.timestamp.toDateString() === today)
                    .reduce((sum, tx) => sum + tx.amount, 0);
                
                const todayRemaining = Math.max(0, dailyGuiltFreeAmount - todaySpent);
                const spentPercentage = todaySpent / dailyGuiltFreeAmount;
                const overspentAmount = Math.max(0, todaySpent - dailyGuiltFreeAmount);
                
                // Determine spending state for contextual messaging
                let spendingState = 'under';
                if (spentPercentage >= 0.95 && spentPercentage <= 1.05) {
                    spendingState = 'perfect';
                } else if (spentPercentage > 1.05) {
                    spendingState = 'over';
                }
                
                // Tomorrow calculation with overspending impact
                const baseTomorrowAmount = Math.round(rawDailyAmount / 5) * 5;
                const tomorrowAdjustment = overspentAmount > 0 ? Math.round(overspentAmount / 5) * 5 : 0;
                const tomorrowAmount = Math.max(0, baseTomorrowAmount - tomorrowAdjustment);
                
                return {
                    dailyGuiltFreeAmount: Math.max(0, dailyGuiltFreeAmount),
                    todayRemaining,
                    todaySpent,
                    spentPercentage: Math.min(spentPercentage, 2), // Cap at 200% for visual
                    overspentAmount,
                    spendingState,
                    remainingSpendBudget,
                    totalSpent,
                    spendAllocation,
                    stashAmount: availableIncome * budget.allocation.stash,
                    saveAmount: availableIncome * budget.allocation.save,
                    progressPercentage: ((currentMonth.daysTotal - currentMonth.daysRemaining) / currentMonth.daysTotal) * 100,
                    tomorrowAmount,
                    tomorrowAdjustment
                };
            };

            const flowData = calculateGuiltFreeFlow();

            // Quick suggestions for guilt-free spending
            const guiltFreeSuggestions = [
                { amount: 5, label: 'Coffee ☕', description: '$5', icon: '☕', merchantId: 'coffee_generic' },
                { amount: 15, label: 'Lunch 🍕', description: '$15', icon: '🍕', merchantId: 'lunch_generic' },
                { amount: 5, label: 'Snack 🍿', description: '$5', icon: '🍿', merchantId: 'snacks_generic' },
                { amount: 0, label: 'Custom 💳', description: 'Custom', icon: '💳', merchantId: 'custom' }
            ];

            // Contextual guilt-free messages based on spending state
            const guiltFreeMessages = {
                under: [
                    "🎉 Guilt-free purchase confirmed! You're doing amazing!",
                    "✨ Perfect choice! This is exactly what your budget is for!",
                    "💚 Approved! You've earned this guilt-free spending!"
                ],
                perfect: [
                    "🎯 Amazing control! Almost perfect spending today!",
                    "⭐ You're hitting your target perfectly!",
                    "🔥 Incredible precision! You know your budget!"
                ],
                over: [
                    "💛 Using tomorrow's money - totally fine!",
                    "🤗 No worries! We'll adjust tomorrow's amount",
                    "✅ Still approved! Tomorrow gets a small adjustment"
                ]
            };

            // Show permission toast with contextual messaging
            const showPermissionToast = () => {
                const messages = guiltFreeMessages[flowData.spendingState];
                const message = messages[Math.floor(Math.random() * messages.length)];
                
                setToastMessage(message);
                setShowToast(true);
                setTimeout(() => setShowToast(false), 3000);
            };

            // Handle guilt-free purchase with $5 rounding
            const handleGuiltFreePurchase = (amount, description, merchantId) => {
                // Round to nearest $5
                const roundedAmount = Math.round(amount / 5) * 5;
                
                const newTransaction = {
                    id: Date.now(),
                    amount: roundedAmount,
                    description: description,
                    category: 'spend',
                    timestamp: new Date(),
                    merchantId: merchantId || null,
                    guiltFree: true
                };
                
                setState(prev => ({
                    ...prev,
                    transactions: [newTransaction, ...prev.transactions],
                    gamification: {
                        ...prev.gamification,
                        totalGuiltFreeExpenses: prev.gamification.totalGuiltFreeExpenses + 1,
                        currentStreak: prev.gamification.currentStreak + (Math.random() > 0.8 ? 1 : 0)
                    }
                }));
                
                setCustomAmount('');
                
                setTimeout(() => {
                    showPermissionToast();
                }, 500);
            };

            // Handle custom purchase
            const handleCustomPurchase = () => {
                const amount = parseFloat(customAmount);
                if (amount > 0) {
                    handleGuiltFreePurchase(amount, 'Custom Purchase', 'custom');
                }
            };

            // Simulate haptic feedback
            const triggerHaptic = (intensity = 'medium') => {
                if (navigator.vibrate) {
                    const patterns = { light: [10], medium: [20], strong: [50] };
                    navigator.vibrate(patterns[intensity] || patterns.medium);
                }
            };

            // Get time-based greeting
            const getGreeting = () => {
                const hour = new Date().getHours();
                if (hour < 12) return 'Good morning, Sarah! ☀️';
                if (hour < 17) return 'Good afternoon, Sarah! ☀️';
                return 'Good evening, Sarah! 🌙';
            };

            const getTimeContext = () => {
                const hour = new Date().getHours();
                if (hour < 12) return 'Perfect time for a guilt-free coffee';
                if (hour < 17) return 'Perfect time for a guilt-free treat';
                return 'Perfect time to enjoy your money';
            };

            // Create dual progress ring
            const createProgressRing = () => {
                const baseProgress = Math.min(flowData.spentPercentage, 1);
                const overProgress = Math.max(0, flowData.spentPercentage - 1);
                
                return (
                    <div className="w-32 h-32 mx-auto relative mb-4">
                        <svg className="w-32 h-32 transform -rotate-90" viewBox="0 0 120 120">
                            {/* Background circle */}
                            <circle cx="60" cy="60" r="50" stroke="rgba(255, 255, 255, 0.1)" strokeWidth="8" fill="none"></circle>
                            
                            {/* Green progress circle (base spending) */}
                            <circle 
                                cx="60" cy="60" r="50" 
                                stroke="url(#progressGradient)" 
                                strokeWidth="8" 
                                fill="none" 
                                strokeLinecap="round" 
                                strokeDasharray={2 * Math.PI * 50} 
                                strokeDashoffset={2 * Math.PI * 50 * (1 - baseProgress)} 
                                className="transition-all duration-700">
                            </circle>
                            
                            {/* Red overlay circle (overspending) */}
                            {flowData.spentPercentage > 1 && (
                                <circle 
                                    cx="60" cy="60" r="50" 
                                    stroke="url(#overspentGradient)" 
                                    strokeWidth="6" 
                                    fill="none" 
                                    strokeLinecap="round" 
                                    strokeDasharray={2 * Math.PI * 50} 
                                    strokeDashoffset={2 * Math.PI * 50 * (1 - Math.min(overProgress, 1))} 
                                    className="transition-all duration-700 progress-ring-overlay">
                                </circle>
                            )}
                            
                            <defs>
                                <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stopColor="#10b981"></stop>
                                    <stop offset="100%" stopColor="#22c55e"></stop>
                                </linearGradient>
                                <linearGradient id="overspentGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stopColor="#ef4444"></stop>
                                    <stop offset="100%" stopColor="#f97316"></stop>
                                </linearGradient>
                            </defs>
                        </svg>
                        
                        <div className="absolute inset-0 flex flex-col items-center justify-center">
                            <div className="text-xs text-slate-400 mb-1">Enjoyed Today</div>
                            <div className={`text-lg font-bold ${flowData.overspentAmount > 0 ? 'text-orange-400' : 'text-emerald-400'}`}>
                                ${flowData.todaySpent.toFixed(2)}
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-animated text-white relative overflow-hidden">
                    
                    {/* Permission Toast */}
                    {showToast && (
                        <div className="fixed top-6 left-1/2 transform -translate-x-1/2 z-50 slide-in-from-top-4">
                            <div className="bg-gradient-to-r from-emerald-500 to-cyan-500 text-white px-6 py-4 rounded-2xl font-semibold shadow-2xl">
                                {toastMessage}
                            </div>
                        </div>
                    )}

                    {/* Main Content Container */}
                    <div className="max-w-md mx-auto min-h-screen relative z-10">
                        <div className="pb-24 pt-6">
                            
                            {activeTab === 'guilt-free' && (
                                <div className="px-6 space-y-6 slide-in-from-bottom-4">
                                    
                                    {/* Header */}
                                    <div className="flex justify-between items-center mb-8 p-6 bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl slide-in-from-top-4">
                                        <div>
                                            <h1 className="text-lg font-semibold mb-1">{getGreeting()}</h1>
                                            <p className="text-sm text-slate-400">{getTimeContext()}</p>
                                        </div>
                                        <button onClick={() => setActiveTab('setup')} className="text-slate-400 hover:text-white transition-colors p-2">⚙️</button>
                                    </div>

                                    {/* Hero: Daily Guilt-Free Amount */}
                                    <div 
                                        className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-8 text-center relative overflow-hidden cursor-pointer fade-in-scale"
                                        style={{ boxShadow: '0 12px 32px rgba(16, 185, 129, 0.3)' }}
                                        onClick={() => {
                                            triggerHaptic('strong');
                                            showPermissionToast();
                                        }}>
                                        
                                        {/* Shimmer effect */}
                                        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-emerald-500/10 to-transparent animate-pulse opacity-60"></div>
                                        
                                        <div className="relative z-10">
                                            {/* Permission label */}
                                            <div className="flex items-center justify-center gap-2 text-emerald-400 font-semibold text-sm mb-3 tracking-wide">
                                                <span>✅</span>
                                                <span>PRE-APPROVED TO SPEND</span>
                                            </div>
                                            
                                            {/* Daily amount with proper spacing */}
                                            <div 
                                                className="text-6xl font-bold bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent mb-2 hover:scale-105 transition-transform duration-300"
                                                style={{ letterSpacing: '-1px' }}>
                                                ${flowData.todayRemaining.toFixed(2)}
                                            </div>
                                            
                                            {/* Overspent indicator */}
                                            {flowData.overspentAmount > 0 && (
                                                <div className="text-sm font-medium text-orange-400 mb-3">
                                                    ${flowData.overspentAmount.toFixed(2)} over today's budget
                                                </div>
                                            )}
                                            
                                            {/* Encouragement text with reduced spacing */}
                                            <p className="text-slate-300 font-medium mb-5">
                                                Go ahead, you've earned it! This is YOUR money to enjoy guilt-free 🎉
                                            </p>
                                            
                                            {/* Progress Ring */}
                                            {createProgressRing()}
                                        </div>
                                    </div>

                                    {/* Quick Spending Actions */}
                                    <div className="grid grid-cols-2 gap-4 slide-in-from-bottom-4">
                                        {guiltFreeSuggestions.map((suggestion, idx) => (
                                            <button 
                                                key={idx}
                                                onClick={() => {
                                                    triggerHaptic('medium');
                                                    if (suggestion.merchantId === 'custom') {
                                                        setCustomAmount('');
                                                    } else {
                                                        handleGuiltFreePurchase(suggestion.amount, suggestion.label, suggestion.merchantId);
                                                    }
                                                }}
                                                className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-6 text-center transition-all duration-300 hover:bg-white/12 hover:scale-105 hover:-translate-y-1 active:scale-95"
                                                style={{ boxShadow: '0 8px 25px rgba(99, 102, 241, 0.2)' }}>
                                                <div className="text-3xl mb-3">{suggestion.icon}</div>
                                                <div className="font-semibold text-white mb-1">{suggestion.label}</div>
                                                <div className="text-xs text-slate-400">{suggestion.description}</div>
                                            </button>
                                        ))}
                                    </div>

                                    {/* Custom Amount Entry */}
                                    <div className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-6">
                                        <h3 className="font-semibold mb-4 text-center">💳 Custom Guilt-Free Amount</h3>
                                        <div className="flex gap-3">
                                            <input 
                                                type="number" 
                                                placeholder="Enter amount" 
                                                value={customAmount}
                                                onChange={(e) => setCustomAmount(e.target.value)}
                                                className="flex-1 bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-400/50">
                                            </input>
                                            <button 
                                                onClick={handleCustomPurchase}
                                                disabled={!customAmount || parseFloat(customAmount) <= 0}
                                                className="bg-gradient-to-r from-emerald-500 to-cyan-500 disabled:from-gray-600 disabled:to-gray-600 rounded-xl px-6 py-3 font-semibold transition-all duration-300 hover:scale-105 active:scale-95 disabled:cursor-not-allowed">
                                                Approve
                                            </button>
                                        </div>
                                    </div>

                                    {/* Tomorrow Preview */}
                                    <div className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-6 slide-in-from-right-4">
                                        <div className="text-sm text-slate-400 mb-2">Tomorrow's Guilt-Free Amount</div>
                                        <div className="text-3xl font-bold bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent">
                                            ${flowData.tomorrowAmount.toFixed(2)}
                                        </div>
                                        
                                        {flowData.tomorrowAdjustment > 0 ? (
                                            <div className="flex items-center gap-2 mt-3 text-sm text-orange-400 font-medium">
                                                <span>⚠️</span>
                                                <span>${flowData.tomorrowAdjustment.toFixed(2)} less due to today's overspending</span>
                                            </div>
                                        ) : flowData.todayRemaining > 0 ? (
                                            <div className="flex items-center gap-2 mt-3 text-sm text-emerald-400 font-medium">
                                                <span>🎁</span>
                                                <span>Plus any leftover from today!</span>
                                            </div>
                                        ) : null}
                                    </div>

                                    {/* Spending Streak */}
                                    <div className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-6 slide-in-from-left-4">
                                        <div className="flex items-center gap-3 mb-4">
                                            <div className="w-12 h-12 bg-gradient-to-r from-pink-500 to-rose-500 rounded-2xl flex items-center justify-center text-2xl animate-pulse">🔥</div>
                                            <div>
                                                <div className="font-bold text-lg">{state.gamification.currentStreak}-Day Guilt-Free Streak!</div>
                                                <div className="text-sm text-slate-400">You're absolutely crushing this budget thing ✨</div>
                                            </div>
                                        </div>
                                        <div className="flex gap-2">
                                            {['M', 'T', 'W', 'T', 'F', 'S', 'S'].map((day, idx) => (
                                                <div 
                                                    key={idx}
                                                    className={`w-8 h-8 rounded-lg flex items-center justify-center text-xs font-semibold ${
                                                        idx < state.gamification.currentStreak 
                                                            ? 'bg-emerald-500 text-white' 
                                                            : idx === state.gamification.currentStreak 
                                                                ? 'bg-cyan-500 text-white animate-pulse' 
                                                                : 'bg-white/10 text-slate-400'
                                                    }`}>
                                                    {day}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Recent Guilt-Free Purchases */}
                                    <div className="bg-white/8 backdrop-blur-sm border border-white/12 rounded-3xl p-6 fade-in-scale">
                                        <div className="flex justify-between items-center mb-5">
                                            <h3 className="font-semibold flex items-center gap-2">
                                                <span>💚</span>
                                                <span>Recent Guilt-Free Wins</span>
                                            </h3>
                                            <button className="text-sm text-purple-400 font-medium hover:text-purple-300 transition-colors">See all →</button>
                                        </div>
                                        <div className="space-y-3">
                                            {state.transactions.slice(0, 3).map(tx => (
                                                <div key={tx.id} className="flex items-center gap-4 p-4 bg-emerald-500/5 border border-emerald-500/10 rounded-2xl cursor-pointer hover:bg-emerald-500/10 transition-all duration-300 hover:translate-x-1 relative">
                                                    <div className="absolute top-2 right-3 text-xs opacity-70">✅</div>
                                                    <div className="w-10 h-10 bg-gradient-to</script></body></html>