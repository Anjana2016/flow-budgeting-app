<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>💚 Flow Budgeting v3.4 - Your Financial Freedom</title>

    <!-- 
VERSION: 3.4-COMPLETE-ALL-FEATURES ✅
STATUS: Production Ready - All 3 Tabs + Modals + Transaction Management Complete
DATE: July 09, 2025

COMPLETE FEATURES v3.4:
✅ 3-Tab System: Daily Flow, Budget Health, Your Journey (All Complete)
✅ Enhanced Journey Tab: 4-component milestone system with real-time calculations
✅ Education Modal: Complete 5-topic system with interactive playground
✅ Settings Modal: Comprehensive 6-section configuration system
✅ Recent Transactions: Full CRUD operations with edit/delete buttons
✅ Contextual Tooltips: 7+ interactive help points across all components
✅ Advanced UI/UX: Glassmorphism, animations, responsive design
✅ Real-time Calculations: Dynamic updates across all tabs and modals
✅ Achievement System: Progressive unlocks and milestone tracking
✅ Complete Accessibility: Keyboard navigation, ARIA labels, mobile optimization

FINAL IMPLEMENTATION DETAILS:
📱 Daily Flow Tab: Quick actions, transactions with edit/delete, achievement badges, progress tracking
💚 Budget Health Tab: 3-category system (Secure/Save/Spend) with health indicators
🎯 Journey Tab: Identity badge, timeline, future projections, detailed milestones
📚 Education Modal: Budgeting, Psychology, Goals, Advanced, Tools + Playground
⚙️ Settings Modal: Profile, Budget, Preferences, Privacy, Data, About sections
🔄 Transaction Management: Full edit/delete functionality with hover controls
🎯 Contextual Help: Smart tooltips with actionable guidance throughout app

PRODUCTION NOTES:
- All calculations dynamically connected and updating in real-time
- Complete responsive design for mobile, tablet, and desktop
- Accessibility compliant with proper keyboard navigation
- Error handling and edge case management implemented
- Performance optimized with efficient event handling
- Transaction management with persistent state

VERSION HISTORY:
v3.1 (July 08, 2025): Education Modal System
v3.2 (July 09, 2025): Enhanced Journey Tab with 4-Component System  
v3.3 (July 09, 2025): Complete Settings Modal + Final Production Polish
v3.4 (July 09, 2025): Transaction CRUD - Edit/Delete Buttons Complete
-->

    <style>
        /* ===== DESIGN SYSTEM & CSS VARIABLES ===== */
        :root {
            /* Core Brand Colors */
            --primary-bg: #0F0F1A;
            --secondary-bg: #1A1A2E;
            --surface-primary: #16213E;
            --surface-secondary: #0E3460;

            /* Glass Morphism System */
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.06);
            --glass-hover: rgba(255, 255, 255, 0.08);
            --backdrop-blur: blur(24px);

            /* Typography Scale */
            --text-primary: #FFFFFF;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --text-tertiary: rgba(255, 255, 255, 0.6);
            --text-muted: rgba(255, 255, 255, 0.4);

            /* Accent Color Palette */
            --accent-green: #10B981;
            --accent-blue: #3B82F6;
            --accent-purple: #8B5CF6;
            --accent-pink: #EC4899;
            --accent-amber: #F59E0B;
            --accent-red: #EF4444;
            --accent-cyan: #06B6D4;

            /* Card System */
            --card-bg: rgba(255, 255, 255, 0.02);
            --card-border: rgba(255, 255, 255, 0.05);
            --card-hover: rgba(255, 255, 255, 0.08);

            /* Elevation & Shadows */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.15);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.25);
            --shadow-glow: 0 0 32px rgba(16, 185, 129, 0.05);

            /* Animation System */
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);

            /* Layout Variables */
            --border-radius: 16px;
            --border-radius-sm: 12px;
            --border-radius-lg: 24px;
            --nav-height: 80px;

            /* Responsive Breakpoints */
            --mobile-max: 480px;
            --tablet-max: 768px;

            /* Journey-specific variables */
            --journey-gradient-identity: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
            --journey-gradient-timeline: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            --journey-gradient-future: linear-gradient(135deg, var(--accent-amber), var(--accent-orange));
        }

        /* ===== BASE RESET & TYPOGRAPHY ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            font-weight: 400;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ===== TAB HEADER CONSISTENCY ===== */
        .tab-main-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            text-align: center;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            -moz-background-clip: text;
            -moz-text-fill-color: transparent;
        }

        .tab-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 32px;
        }

        /* Tab-specific title colors */
        .daily-flow .tab-main-title {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-amber));
            background-clip: text;
            -webkit-background-clip: text;
        }

        .budget-health .tab-main-title {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-green));
            background-clip: text;
            -webkit-background-clip: text;
        }

        .your-journey .tab-main-title {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
            background-clip: text;
            -webkit-background-clip: text;
        }

        /* Browser fallbacks for gradient text */
        @supports not (background-clip: text) {
            .tab-main-title {
                color: var(--text-primary);
            }
        }

        /* ===== ENHANCED HEADER SYSTEM ===== */
        .app-header {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--glass-border);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .app-logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 800;
            color: white;
        }

        .app-name {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .icon-button {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .icon-button:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
            transform: translateY(-1px);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 0 0 100px 0;
            max-width: 480px;
            margin: 0 auto;
            width: 100%;
        }

        .tab-content {
            display: none;
            padding: 20px;
            animation: fadeInUp 0.4s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Daily Flow Tab */
        .daily-summary {
            background: var(--card-bg);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-glow);
        }

        .daily-amount {
            text-align: center;
            margin-bottom: 20px;
        }

        .daily-label {
            font-size: 14px;
            color: var(--text-tertiary);
            margin-bottom: 8px;
        }

        .daily-value {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .daily-context {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .progress-section {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 16px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .progress-label {
            font-size: 14px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .progress-amount {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            border-radius: 4px;
            transition: width 0.5s var(--transition-smooth);
        }

        /* Achievement Badges */
        .achievement-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 24px 0;
        }

        .badge-container {
            text-align: center;
        }

        .badge-icon-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-amber), #F97316);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 8px;
            margin: 0 auto 8px auto;
            box-shadow: var(--shadow-md);
        }

        .badge-text {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .quick-action {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius-sm);
            padding: 16px 12px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition-smooth);
            color: inherit;
            text-decoration: none;
        }

        .quick-action:hover {
            background: var(--card-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .quick-action-content {
            margin-bottom: 8px;
        }

        .quick-action-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .quick-action-amount {
            font-size: 16px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .quick-action-label {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        /* Recent Transactions */
        .recent-transactions {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 20px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .transaction-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .transaction-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .transaction-details {
            display: flex;
            flex-direction: column;
        }

        .transaction-description {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .transaction-category {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .transaction-amount {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-red);
        }

        /* Transaction Actions & Buttons - EXACT COPY FROM WORKING VERSION */
        .transaction-item:hover {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            margin: 0 -8px;
            padding: 12px 8px;
        }

        .transaction-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .transaction-buttons {
            display: flex;
            gap: 6px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .transaction-item:hover .transaction-buttons {
            opacity: 1;
        }

        .transaction-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .transaction-btn:hover {
            transform: scale(1.1);
        }

        .transaction-btn.edit {
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
        }

        .transaction-btn.delete {
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
        }

        .category-icon {
            font-size: 12px;
            margin-left: 4px;
        }

        /* Budget Health Tab */
        .budget-overview {
            display: grid;
            gap: 16px;
            margin-bottom: 24px;
        }

        .budget-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .budget-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-blue);
        }

        .budget-card.secure::before {
            background: var(--accent-blue);
        }

        .budget-card.save::before {
            background: var(--accent-purple);
        }

        .budget-card.spend::before {
            background: var(--accent-green);
        }

        .budget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .budget-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .budget-percentage {
            font-size: 14px;
            color: var(--text-secondary);
            background: rgba(59, 130, 246, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
        }

        .budget-amount {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .budget-description {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 16px;
        }

        /* ENHANCED: Health Status & Progress Indicators */
        .budget-health-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .health-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .health-icon {
            font-size: 16px;
        }

        .health-status {
            font-size: 14px;
            font-weight: 600;
        }

        .health-status.excellent {
            color: var(--accent-green);
        }

        .health-status.good {
            color: var(--accent-blue);
        }

        .health-status.warning {
            color: var(--accent-amber);
        }

        .usage-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .usage-label {
            color: var(--text-tertiary);
        }

        .usage-amount {
            font-weight: 600;
        }

        .secure-used,
        .secure-remaining {
            color: var(--accent-blue);
        }

        .save-current,
        .save-total {
            color: var(--accent-purple);
        }

        .spend-current,
        .spend-remaining {
            color: var(--accent-green);
        }

        .category-progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .category-progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s var(--transition-smooth);
        }

        .secure-progress-fill {
            background: linear-gradient(90deg, var(--accent-blue), #60A5FA);
        }

        .save-progress-fill {
            background: linear-gradient(90deg, var(--accent-purple), #A78BFA);
        }

        .spend-progress-fill {
            background: linear-gradient(90deg, var(--accent-green), #34D399);
        }

        /* ===== JOURNEY TAB ENHANCEMENT SYSTEM ===== */

        /* 1. COMPACT IDENTITY BADGE */
        .journey-identity-badge {
            background: var(--journey-gradient-identity);
            border-radius: var(--border-radius);
            padding: 16px 20px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .journey-identity-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--backdrop-blur);
        }

        .journey-identity-main {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 2;
        }

        .journey-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #FFF, #F0F0F0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-md);
        }

        .journey-identity-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .journey-level-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 600;
            color: white;
        }

        .journey-streak {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .journey-streak-fire {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .journey-progress-section {
            position: relative;
            z-index: 2;
            text-align: right;
        }

        .journey-progress-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 4px;
        }

        .journey-progress-bar {
            width: 100px;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 2px;
        }

        .journey-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFF, rgba(255, 255, 255, 0.8));
            border-radius: 4px;
            transition: width 0.5s var(--transition-smooth);
        }

        .journey-progress-amount {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* 2. 4-MILESTONE TIMELINE */
        .journey-timeline {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 24px;
        }

        .journey-timeline-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .journey-timeline-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .journey-timeline-subtitle {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .journey-timeline-track {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            margin: 20px 0;
        }

        .journey-timeline-line {
            position: absolute;
            top: 50%;
            left: 24px;
            right: 24px;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-50%);
        }

        .journey-timeline-progress {
            position: absolute;
            top: 50%;
            left: 24px;
            height: 2px;
            background: var(--journey-gradient-timeline);
            transform: translateY(-50%);
            transition: width 0.8s var(--transition-smooth);
        }

        .journey-milestone {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            position: relative;
            z-index: 2;
        }

        .journey-milestone-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: var(--transition-smooth);
            box-shadow: var(--shadow-sm);
        }

        .journey-milestone.completed .journey-milestone-icon {
            background: var(--accent-green);
            color: white;
        }

        .journey-milestone.current .journey-milestone-icon {
            background: var(--accent-blue);
            color: white;
            animation: bounce 2s infinite;
        }

        .journey-milestone.upcoming .journey-milestone-icon {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-tertiary);
        }

        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-4px);
            }

            60% {
                transform: translateY(-2px);
            }
        }

        .journey-milestone-label {
            font-size: 11px;
            font-weight: 500;
            text-align: center;
            max-width: 60px;
            line-height: 1.2;
        }

        .journey-milestone.completed .journey-milestone-label {
            color: var(--accent-green);
        }

        .journey-milestone.current .journey-milestone-label {
            color: var(--accent-blue);
        }

        .journey-milestone.upcoming .journey-milestone-label {
            color: var(--text-tertiary);
        }

        .journey-milestone-countdown {
            font-size: 10px;
            color: var(--text-muted);
            text-align: center;
        }

        /* 3. STANDOUT FUTURE CARD */
        .journey-future-container {
            background: var(--journey-gradient-future);
            border-radius: var(--border-radius-lg);
            padding: 24px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .journey-future-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--backdrop-blur);
        }

        .journey-future-content {
            position: relative;
            z-index: 2;
        }

        .journey-future-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .journey-future-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .journey-future-title {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .journey-future-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .journey-future-projections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .journey-projection-item {
            text-align: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            backdrop-filter: blur(8px);
        }

        .journey-projection-timeframe {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 4px;
        }

        .journey-projection-amount {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 2px;
        }

        .journey-projection-icon {
            font-size: 14px;
        }

        .journey-future-impact {
            text-align: center;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(8px);
        }

        .journey-impact-text {
            font-size: 14px;
            color: white;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .journey-impact-calculation {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* 4. DETAILED MILESTONE LIST */
        .journey-milestones-container {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 20px;
        }

        .journey-milestones-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .journey-milestones-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .journey-milestones-subtitle {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .journey-milestone-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition-smooth);
        }

        .journey-milestone-item:last-child {
            border-bottom: none;
        }

        .journey-milestone-item:hover {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            margin: 0 -8px;
            padding: 12px 8px;
        }

        .journey-milestone-item-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .journey-milestone-item.achieved .journey-milestone-item-icon {
            background: var(--accent-green);
            color: white;
        }

        .journey-milestone-item.current .journey-milestone-item-icon {
            background: var(--accent-blue);
            color: white;
        }

        .journey-milestone-item.upcoming .journey-milestone-item-icon {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-tertiary);
        }

        .journey-milestone-item-content {
            flex: 1;
        }

        .journey-milestone-item-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .journey-milestone-item.achieved .journey-milestone-item-title {
            color: var(--accent-green);
        }

        .journey-milestone-item.current .journey-milestone-item-title {
            color: var(--accent-blue);
        }

        .journey-milestone-item.upcoming .journey-milestone-item-title {
            color: var(--text-secondary);
        }

        .journey-milestone-item-description {
            font-size: 12px;
            color: var(--text-tertiary);
            line-height: 1.3;
        }

        .journey-milestone-item-status {
            text-align: right;
            font-size: 11px;
            color: var(--text-muted);
        }

        .journey-milestone-item.achieved .journey-milestone-item-status {
            color: var(--accent-green);
            font-weight: 500;
        }

        .journey-milestone-item.current .journey-milestone-item-status {
            color: var(--accent-blue);
            font-weight: 500;
        }

        /* TOOLTIPS FOR JOURNEY ELEMENTS */
        .journey-tooltip-trigger {
            cursor: pointer;
            position: relative;
        }

        .journey-tooltip-trigger:hover {
            opacity: 0.8;
        }

        /* MOBILE OPTIMIZATIONS */
        @media (max-width: 480px) {
            .journey-identity-badge {
                padding: 14px 16px;
            }

            .journey-avatar {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }

            .journey-progress-bar {
                width: 80px;
            }

            .journey-future-projections {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .journey-milestone-icon {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .journey-milestone-label {
                font-size: 10px;
                max-width: 50px;
            }
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border-top: 1px solid var(--glass-border);
            padding: 12px 0;
            z-index: 200;
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 480px;
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition-smooth);
            color: var(--text-muted);
            text-decoration: none;
        }

        .nav-item.active {
            color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
        }

        .nav-item:hover {
            color: var(--text-secondary);
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        /* Custom Modal (Existing) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 24px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9) translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            transition: var(--transition-smooth);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: var(--card-hover);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border-top: 1px solid var(--glass-border);
            padding: 12px 0;
            z-index: 200;
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 480px;
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition-smooth);
            color: var(--text-muted);
            text-decoration: none;
        }

        .nav-item.active {
            color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
        }

        .nav-item:hover {
            color: var(--text-secondary);
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        /* Custom Modal (Existing) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            padding: 24px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9) translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            transition: var(--transition-smooth);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: var(--card-hover);
        }

        /* ===== SETTINGS MODAL SYSTEM (SURGICAL ADDITION) ===== */
        .settings-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            z-index: 2200;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .settings-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .settings-modal-container {
            background: var(--primary-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            max-width: 440px;
            width: 100%;
            max-height: 85vh;
            overflow: hidden;
            transform: scale(0.9) translateY(30px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-lg);
        }

        .settings-modal-overlay.active .settings-modal-container {
            transform: scale(1) translateY(0);
        }

        .settings-modal-header {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--glass-border);
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .settings-modal-title {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
        }

        .settings-modal-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .settings-close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .settings-close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
        }

        .settings-topic-nav {
            display: flex;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid var(--glass-border);
            padding: 0 4px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .settings-topic-nav::-webkit-scrollbar {
            display: none;
        }

        .settings-topic-btn {
            flex-shrink: 0;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: var(--transition-smooth);
            white-space: nowrap;
        }

        .settings-topic-btn.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
        }

        .settings-topic-btn:hover {
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.05);
        }

        .settings-content-container {
            height: 420px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--glass-border) transparent;
        }

        .settings-content-container::-webkit-scrollbar {
            width: 6px;
        }

        .settings-content-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .settings-content-container::-webkit-scrollbar-thumb {
            background: var(--glass-border);
            border-radius: 3px;
        }

        .settings-topic-content {
            display: none;
            padding: 24px;
            animation: settingsSlideIn 0.3s ease-out;
        }

        .settings-topic-content.active {
            display: block;
        }

        @keyframes settingsSlideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .settings-section {
            margin-bottom: 24px;
        }

        .settings-section-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-form-group {
            margin-bottom: 16px;
        }

        .settings-form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 6px;
            font-weight: 500;
        }

        .settings-form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            transition: var(--transition-smooth);
        }

        .settings-form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            background: rgba(255, 255, 255, 0.08);
        }

        .settings-form-select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .settings-form-select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .settings-period-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .settings-period-option {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .settings-period-option.active {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .settings-period-option:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .settings-period-label {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .settings-period-amount {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .settings-slider-group {
            margin-bottom: 16px;
        }

        .settings-slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .settings-slider-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .settings-slider-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .settings-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .settings-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-blue);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
        }

        .settings-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-blue);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
        }

        .settings-preview-card {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            margin-top: 16px;
        }

        .settings-preview-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-green);
            margin-bottom: 8px;
        }

        .settings-preview-amount {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .settings-preview-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .settings-toggle-group {
            margin-bottom: 16px;
        }

        .settings-toggle-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .settings-toggle-item:last-child {
            border-bottom: none;
        }

        .settings-toggle-info {
            flex: 1;
        }

        .settings-toggle-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .settings-toggle-desc {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .settings-toggle {
            position: relative;
            width: 44px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .settings-toggle.active {
            background: var(--accent-green);
        }

        .settings-toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: var(--transition-smooth);
            transform: translateX(0);
        }

        .settings-toggle.active .settings-toggle-slider {
            transform: translateX(20px);
        }

        .settings-action-btn {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-smooth);
            margin-bottom: 8px;
        }

        .settings-action-btn.primary {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
        }

        .settings-action-btn.secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
        }

        .settings-action-btn.danger {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .settings-action-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .settings-info-card {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
        }

        .settings-info-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 4px;
        }

        .settings-info-text {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Mobile Optimization */
        @media (max-width: 480px) {
            .settings-modal-container {
                margin: 10px;
                max-height: 90vh;
            }

            .settings-topic-nav {
                padding: 0 2px;
            }

            .settings-topic-btn {
                padding: 10px 12px;
                font-size: 12px;
            }

            .settings-topic-content {
                padding: 16px;
            }

            .settings-content-container {
                height: 380px;
            }

            .settings-period-selector {
                grid-template-columns: 1fr;
                gap: 6px;
            }
        }

        /* ===== CONTEXTUAL TOOLTIP SYSTEM (SURGICAL ADDITION - PHASE 1) ===== */
        .contextual-tooltip-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 2100;
        }

        .contextual-tooltip {
            position: absolute;
            background: var(--primary-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px 16px;
            max-width: 280px;
            min-width: 200px;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            visibility: hidden;
            transform: translateY(8px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto;
            z-index: 2101;
        }

        .contextual-tooltip.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .contextual-tooltip-header {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .contextual-tooltip-content {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .contextual-tooltip-action {
            font-size: 12px;
            color: var(--accent-blue);
            font-weight: 500;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .contextual-tooltip-action:hover {
            color: var(--accent-green);
        }

        .contextual-tooltip-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
        }

        .contextual-tooltip-arrow.bottom {
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-top: 6px solid var(--primary-bg);
        }

        .contextual-tooltip-arrow.top {
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-bottom: 6px solid var(--primary-bg);
        }

        .contextual-tooltip-arrow.left {
            left: -6px;
            top: 50%;
            transform: translateY(-50%);
            border-right: 6px solid var(--primary-bg);
        }

        .contextual-tooltip-arrow.right {
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            border-left: 6px solid var(--primary-bg);
        }

        /* Tooltip trigger highlight */
        .contextual-tooltip-trigger {
            position: relative;
            cursor: help;
        }

        .contextual-tooltip-trigger::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 2px solid transparent;
            border-radius: inherit;
            transition: border-color 0.2s ease;
            pointer-events: none;
        }

        .contextual-tooltip-trigger:hover::after {
            border-color: rgba(59, 130, 246, 0.3);
        }

        /* Mobile touch indicators */
        @media (max-width: 768px) {
            .contextual-tooltip {
                max-width: 260px;
                min-width: 180px;
                padding: 10px 14px;
            }

            .contextual-tooltip-header {
                font-size: 13px;
            }

            .contextual-tooltip-content {
                font-size: 12px;
            }
        }

        /* ===== EDUCATION MODAL SYSTEM (SURGICAL ADDITION) ===== */
        .education-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .education-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .education-modal-container {
            background: var(--primary-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            max-width: 420px;
            width: 100%;
            max-height: 85vh;
            overflow: hidden;
            transform: scale(0.9) translateY(30px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-lg);
        }

        .education-modal-overlay.active .education-modal-container {
            transform: scale(1) translateY(0);
        }

        .education-modal-header {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--glass-border);
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .education-modal-title {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
        }

        .education-modal-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .education-close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .education-close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
        }

        .education-topic-nav {
            display: flex;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid var(--glass-border);
            padding: 0 4px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .education-topic-nav::-webkit-scrollbar {
            display: none;
        }

        .education-topic-btn {
            flex-shrink: 0;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: var(--transition-smooth);
            white-space: nowrap;
        }

        .education-topic-btn.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
        }

        .education-topic-btn:hover {
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.05);
        }

        .education-content-container {
            height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--glass-border) transparent;
        }

        .education-content-container::-webkit-scrollbar {
            width: 6px;
        }

        .education-content-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .education-content-container::-webkit-scrollbar-thumb {
            background: var(--glass-border);
            border-radius: 3px;
        }

        .education-topic-content {
            display: none;
            padding: 24px;
            animation: educationSlideIn 0.3s ease-out;
        }

        .education-topic-content.active {
            display: block;
        }

        @keyframes educationSlideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .education-section {
            margin-bottom: 24px;
        }

        .education-section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .education-section-content {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .education-highlight {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
        }

        .education-highlight-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-green);
            margin-bottom: 4px;
        }

        .education-highlight-text {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .education-example {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
        }

        .education-example-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 8px;
        }

        .education-calculation-step {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            margin-bottom: 4px;
        }

        .education-calculation-label {
            color: var(--text-tertiary);
        }

        .education-calculation-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .education-playground {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .education-playground-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--accent-purple);
            margin-bottom: 12px;
            text-align: center;
        }

        .education-playground-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            text-align: center;
            margin-bottom: 12px;
        }

        .education-playground-results {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .education-playground-result {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 8px;
            text-align: center;
        }

        .education-playground-result-label {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-bottom: 4px;
        }

        .education-playground-result-value {
            font-size: 14px;
            font-weight: 700;
        }

        .education-playground-result.secure .education-playground-result-value {
            color: var(--accent-blue);
        }

        .education-playground-result.save .education-playground-result-value {
            color: var(--accent-purple);
        }

        .education-playground-result.spend .education-playground-result-value {
            color: var(--accent-green);
        }

        .education-progress-indicator {
            padding: 16px 20px;
            background: var(--glass-bg);
            border-top: 1px solid var(--glass-border);
            text-align: center;
        }

        .education-progress-text {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .education-progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .education-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .education-modal-container {
                margin: 10px;
                max-height: 90vh;
            }

            .education-topic-nav {
                padding: 0 2px;
            }

            .education-topic-btn {
                padding: 10px 12px;
                font-size: 12px;
            }

            .education-topic-content {
                padding: 16px;
            }

            .education-content-container {
                height: 350px;
            }

            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }

            .achievement-badges {
                gap: 16px;
            }

            .badge-icon-circle {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- Enhanced Header -->
        <header class="app-header">
            <div class="app-logo">
                <div class="logo-icon">F</div>
                <div class="app-name">Flow</div>
            </div>
            <div class="header-actions">
                <button class="icon-button" onclick="showEducationHub()" aria-label="Education Hub">📚</button>
                <button class="icon-button" onclick="showSettings()" aria-label="Settings">⚙️</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Daily Flow Tab -->
            <div class="tab-content daily-flow active" id="dailyFlowTab">
                <h1 class="tab-main-title">Daily Flow</h1>
                <p class="tab-subtitle">Your guilt-free spending guide</p>

                <!-- Daily Summary Card -->
                <div class="daily-summary">
                    <div class="daily-amount">
                        <div class="daily-label">Available Today</div>
                        <div class="daily-value" id="dailyFlowAmount">$40</div>
                        <div class="daily-context" id="dailyFlowContext">Perfect pace to stay on track</div>
                    </div>

                    <div class="progress-section">
                        <div class="progress-header">
                            <span class="progress-label">Monthly Progress</span>
                            <span class="progress-amount" id="progressAmount">$175 of $1,280 spent</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 13.7%;"></div>
                        </div>
                    </div>
                </div>

                <!-- Achievement Badges -->
                <div class="achievement-badges">
                    <div class="badge-container">
                        <div class="badge-icon-circle">☕</div>
                        <div class="badge-text">Coffee Pro</div>
                    </div>
                    <div class="badge-container">
                        <div class="badge-icon-circle">🎯</div>
                        <div class="badge-text">Week Master</div>
                    </div>
                    <div class="badge-container">
                        <div class="badge-icon-circle">💚</div>
                        <div class="badge-text">Flow King</div>
                    </div>
                </div>

                <!-- Quick Actions Grid -->
                <div class="quick-actions">
                    <button class="quick-action" onclick="quickAdd(5, 'Coffee', '☕')">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">☕</div>
                            <div class="quick-action-amount">$5</div>
                        </div>
                        <div class="quick-action-label">Coffee</div>
                    </button>
                    <button class="quick-action" onclick="quickAdd(15, 'Lunch', '🍽️')">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">🍽️</div>
                            <div class="quick-action-amount">$15</div>
                        </div>
                        <div class="quick-action-label">Lunch</div>
                    </button>
                    <button class="quick-action" onclick="quickAdd(25, 'Dinner', '🍕')">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">🍕</div>
                            <div class="quick-action-amount">$25</div>
                        </div>
                        <div class="quick-action-label">Dinner</div>
                    </button>
                    <button class="quick-action" onclick="quickAdd(20, 'Movies', '🎬')">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">🎬</div>
                            <div class="quick-action-amount">$20</div>
                        </div>
                        <div class="quick-action-label">Movies</div>
                    </button>
                    <button class="quick-action" onclick="quickAdd(40, 'Groceries', '🛒')">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">🛒</div>
                            <div class="quick-action-amount">$40</div>
                        </div>
                        <div class="quick-action-label">Groceries</div>
                    </button>
                    <button class="quick-action" onclick="showCustomAddModal()">
                        <div class="quick-action-content">
                            <div class="quick-action-icon">➕</div>
                            <div class="quick-action-amount">Custom</div>
                        </div>
                        <div class="quick-action-label">Add</div>
                    </button>
                </div>

                <!-- Recent Transactions -->
                <div class="recent-transactions">
                    <div class="section-header">
                        <h3 class="section-title">Recent Transactions</h3>
                        <button class="icon-button" onclick="showAllTransactions()">📋</button>
                    </div>
                    <div class="transaction-list" id="recentTransactionsList">
                        <!-- Recent transactions will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Budget Health Tab - ENHANCED WITH HEALTH INDICATORS & PROGRESS -->
            <div class="tab-content budget-health" id="budgetHealthTab">
                <h1 class="tab-main-title">Budget Health</h1>
                <p class="tab-subtitle">Monitor your 3 S's allocation</p>

                <div class="budget-overview">
                    <!-- SECURE Category -->
                    <div class="budget-card secure">
                        <div class="budget-header">
                            <div class="budget-title">💙 SECURE</div>
                            <div class="budget-percentage">55%</div>
                        </div>
                        <div class="budget-amount" id="secureAmount">$1,760</div>
                        <div class="budget-description">
                            Bills, rent, groceries - the essentials you can't skip. This keeps you stable and secure.
                        </div>

                        <div class="budget-health-section">
                            <div class="health-indicator">
                                <div class="health-icon">💚</div>
                                <div class="health-status excellent">Excellent Health</div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Used this month:</span>
                                <span class="usage-amount secure-used" id="secureUsed">$1,420</span>
                            </div>
                            <div class="category-progress-bar">
                                <div class="category-progress-fill secure-progress-fill" id="secureProgressFill"
                                    style="width: 80.7%;"></div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Remaining:</span>
                                <span class="usage-amount secure-remaining" id="secureRemaining">$340</span>
                            </div>
                        </div>
                    </div>

                    <!-- SAVE Category -->
                    <div class="budget-card save">
                        <div class="budget-header">
                            <div class="budget-title">💜 SAVE</div>
                            <div class="budget-percentage">10%</div>
                        </div>
                        <div class="budget-amount" id="saveAmount">$320</div>
                        <div class="budget-description">
                            Future goals, emergency fund, long-term dreams. This builds your wealth automatically.
                        </div>

                        <div class="budget-health-section">
                            <div class="health-indicator">
                                <div class="health-icon">💚</div>
                                <div class="health-status excellent">Excellent Health</div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Saved this month:</span>
                                <span class="usage-amount save-current" id="saveCurrentMonth">$320</span>
                            </div>
                            <div class="category-progress-bar">
                                <div class="category-progress-fill save-progress-fill" id="saveProgressFill"
                                    style="width: 100%;"></div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Total saved:</span>
                                <span class="usage-amount save-total" id="saveTotalAmount">$980</span>
                            </div>
                        </div>
                    </div>

                    <!-- SPEND Category -->
                    <div class="budget-card spend">
                        <div class="budget-header">
                            <div class="budget-title">💚 SPEND</div>
                            <div class="budget-percentage">35%</div>
                        </div>
                        <div class="budget-amount" id="spendAmount">$1,280</div>
                        <div class="budget-description">
                            Everything else - coffee, entertainment, shopping, and spontaneous fun. Spend this
                            guilt-free knowing your future is secure.
                        </div>

                        <div class="budget-health-section">
                            <div class="health-indicator">
                                <div class="health-icon">💚</div>
                                <div class="health-status excellent">Excellent Health</div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Spent this month:</span>
                                <span class="usage-amount spend-current" id="spendCurrentMonth">$175</span>
                            </div>
                            <div class="category-progress-bar">
                                <div class="category-progress-fill spend-progress-fill" id="spendProgressFill"
                                    style="width: 13.7%;"></div>
                            </div>

                            <div class="usage-metric">
                                <span class="usage-label">Remaining:</span>
                                <span class="usage-amount spend-remaining" id="spendRemaining">$1,105</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Your Journey Tab -->
            <div class="tab-content your-journey" id="yourJourneyTab">
                <h1 class="tab-main-title">Your Journey</h1>
                <p class="tab-subtitle">Track your financial growth and celebrate milestones</p>

                <!-- 1. Compact Identity Badge -->
                <div class="journey-identity-badge journey-tooltip-trigger" onclick="showJourneyTooltip('identity')">
                    <div class="journey-identity-main">
                        <div class="journey-avatar" id="journeyAvatar">💪</div>
                        <div class="journey-identity-info">
                            <div class="journey-level-badge">
                                <span>⚡</span>
                                <span id="journeyLevelName">Building Wealth Warrior</span>
                            </div>
                            <div class="journey-streak">
                                <span class="journey-streak-fire">🔥</span>
                                <span id="journeyStreakDays">12</span>
                                <span>day streak</span>
                            </div>
                        </div>
                    </div>
                    <div class="journey-progress-section">
                        <div class="journey-progress-text">Level 3 Progress</div>
                        <div class="journey-progress-bar">
                            <div class="journey-progress-fill" id="journeyProgressFill" style="width: 87%;"></div>
                        </div>
                        <div class="journey-progress-amount" id="journeyProgressAmount">$1,305 / $1,500</div>
                    </div>
                </div>

                <!-- 2. 4-Milestone Timeline -->
                <div class="journey-timeline journey-tooltip-trigger" onclick="showJourneyTooltip('timeline')">
                    <div class="journey-timeline-header">
                        <div class="journey-timeline-title">Next Milestones</div>
                        <div class="journey-timeline-subtitle">Your path to financial freedom</div>
                    </div>
                    <div class="journey-timeline-track">
                        <div class="journey-timeline-line"></div>
                        <div class="journey-timeline-progress" style="width: 75%;"></div>

                        <div class="journey-milestone completed">
                            <div class="journey-milestone-icon">✅</div>
                            <div class="journey-milestone-label">First<br>Save</div>
                        </div>

                        <div class="journey-milestone completed">
                            <div class="journey-milestone-icon">💰</div>
                            <div class="journey-milestone-label">$500<br>Saved</div>
                        </div>

                        <div class="journey-milestone current">
                            <div class="journey-milestone-icon">🎯</div>
                            <div class="journey-milestone-label">Level<br>Up</div>
                            <div class="journey-milestone-countdown">13 days</div>
                        </div>

                        <div class="journey-milestone upcoming">
                            <div class="journey-milestone-icon">🚀</div>
                            <div class="journey-milestone-label">$2,500<br>Goal</div>
                            <div class="journey-milestone-countdown">3 months</div>
                        </div>
                    </div>
                </div>

                <!-- 3. Standout Future Card -->
                <div class="journey-future-container journey-tooltip-trigger" onclick="showJourneyTooltip('future')">
                    <div class="journey-future-content">
                        <div class="journey-future-header">
                            <div class="journey-future-icon">🔮</div>
                            <div class="journey-future-title">Your Future Self</div>
                            <div class="journey-future-subtitle">Based on your current Flow habits</div>
                        </div>

                        <div class="journey-future-projections">
                            <div class="journey-projection-item">
                                <div class="journey-projection-timeframe">In 6 Months</div>
                                <div class="journey-projection-amount" id="journeySixMonthProjection">$4,305</div>
                                <div class="journey-projection-icon">💪</div>
                            </div>
                            <div class="journey-projection-item">
                                <div class="journey-projection-timeframe">In 1 Year</div>
                                <div class="journey-projection-amount" id="journeyOneYearProjection">$7,305</div>
                                <div class="journey-projection-icon">🚀</div>
                            </div>
                        </div>

                        <div class="journey-future-impact">
                            <div class="journey-impact-text">That's $18,000 annual budget power! 💰</div>
                            <div class="journey-impact-calculation">$500/month × 12 months + compound growth</div>
                        </div>
                    </div>
                </div>

                <!-- 4. Detailed Milestone List -->
                <div class="journey-milestones-container">
                    <div class="journey-milestones-header">
                        <div class="journey-milestones-title">Achievement Timeline</div>
                        <div class="journey-milestones-subtitle">Your financial milestones and progress</div>
                    </div>

                    <div class="journey-milestone-item achieved">
                        <div class="journey-milestone-item-icon">🌱</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">Started Your Journey</div>
                            <div class="journey-milestone-item-description">Took the first step toward financial freedom
                            </div>
                        </div>
                        <div class="journey-milestone-item-status">✅ Day 1</div>
                    </div>

                    <div class="journey-milestone-item achieved">
                        <div class="journey-milestone-item-icon">☕</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">First Week Complete</div>
                            <div class="journey-milestone-item-description">Tracked spending for 7 consecutive days
                            </div>
                        </div>
                        <div class="journey-milestone-item-status">✅ Day 7</div>
                    </div>

                    <div class="journey-milestone-item achieved">
                        <div class="journey-milestone-item-icon">�</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">$500 Savings Milestone</div>
                            <div class="journey-milestone-item-description">Built your emergency fund foundation</div>
                        </div>
                        <div class="journey-milestone-item-status">✅ Day 15</div>
                    </div>

                    <div class="journey-milestone-item current">
                        <div class="journey-milestone-item-icon">🎯</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">Level 4: Future Builder</div>
                            <div class="journey-milestone-item-description">Reach $1,500 saved to unlock new features
                            </div>
                        </div>
                        <div class="journey-milestone-item-status">87% Complete</div>
                    </div>

                    <div class="journey-milestone-item upcoming">
                        <div class="journey-milestone-item-icon">🚀</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">$2,500 Wealth Goal</div>
                            <div class="journey-milestone-item-description">Achieve serious wealth building momentum
                            </div>
                        </div>
                        <div class="journey-milestone-item-status">In 3 months</div>
                    </div>

                    <div class="journey-milestone-item upcoming">
                        <div class="journey-milestone-item-icon">💎</div>
                        <div class="journey-milestone-item-content">
                            <div class="journey-milestone-item-title">Wealth Master Status</div>
                            <div class="journey-milestone-item-description">$5,000 saved - true financial security</div>
                        </div>
                        <div class="journey-milestone-item-status">In 8 months</div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-container">
                <a class="nav-item active" onclick="switchTab('dailyFlow')">
                    <span class="nav-icon">💚</span>
                    <span class="nav-label">Daily Flow</span>
                </a>
                <a class="nav-item" onclick="switchTab('budgetHealth')">
                    <span class="nav-icon">🎯</span>
                    <span class="nav-label">Budget Health</span>
                </a>
                <a class="nav-item" onclick="switchTab('yourJourney')">
                    <span class="nav-icon">✨</span>
                    <span class="nav-label">Your Journey</span>
                </a>
            </div>
        </nav>

        <!-- Custom Add Modal (Existing) -->
        <div class="modal-overlay" id="customAddModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Add Custom Expense</h2>
                    <p class="modal-subtitle">Track your spending in real-time</p>
                </div>

                <div class="form-group">
                    <label class="form-label" for="customAmount">Amount ($)</label>
                    <input type="number" id="customAmount" class="form-input" placeholder="0.00" min="0" step="0.01">
                </div>

                <div class="form-group">
                    <label class="form-label" for="customDescription">Description</label>
                    <input type="text" id="customDescription" class="form-input" placeholder="What did you spend on?">
                </div>

                <div class="form-group">
                    <label class="form-label" for="customCategory">Category (Optional)</label>
                    <select id="customCategory" class="form-select">
                        <option value="">Select a category</option>
                        <option value="food">🍽️ Food & Dining</option>
                        <option value="entertainment">🎬 Entertainment</option>
                        <option value="shopping">🛒 Shopping</option>
                        <option value="transport">🚗 Transportation</option>
                        <option value="health">🏥 Health & Fitness</option>
                        <option value="education">📚 Education</option>
                        <option value="other">✨ Other</option>
                    </select>
                </div>

                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeCustomAddModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="addCustomExpense()">Add Expense</button>
                </div>
            </div>
        </div>

        <!-- ===== EDUCATION MODAL SYSTEM (SURGICAL ADDITION) ===== -->
        <div class="education-modal-overlay" id="educationModalOverlay">
            <div class="education-modal-container">
                <!-- Modal Header -->
                <div class="education-modal-header">
                    <h2 class="education-modal-title">🎓 Flow Education</h2>
                    <p class="education-modal-subtitle">Master your financial flow in minutes</p>
                    <button class="education-close-btn" onclick="closeEducationModal()">×</button>
                </div>

                <!-- Topic Navigation -->
                <div class="education-topic-nav">
                    <button class="education-topic-btn active" onclick="switchEducationTopic('overview')">🏠 What is
                        Flow?</button>
                    <button class="education-topic-btn" onclick="switchEducationTopic('categories')">💰 The 3
                        S's</button>
                    <button class="education-topic-btn" onclick="switchEducationTopic('calculation')">⚡ Daily
                        Flow</button>
                    <button class="education-topic-btn" onclick="switchEducationTopic('allocations')">🎯
                        Allocations</button>
                    <button class="education-topic-btn" onclick="switchEducationTopic('scenarios')">💡 Real
                        Life</button>
                </div>

                <!-- Content Container -->
                <div class="education-content-container">
                    <!-- Topic 1: What is Flow? -->
                    <div class="education-topic-content active" id="educationTopicOverview">
                        <div class="education-section">
                            <h3 class="education-section-title">🚀 Why Flow Exists</h3>
                            <div class="education-section-content">
                                Traditional budgeting sucks. You track every penny, feel guilty about spending, and
                                still don't know if you can afford that coffee. Flow changes everything.
                            </div>

                            <div class="education-highlight">
                                <div class="education-highlight-title">The Flow Promise</div>
                                <div class="education-highlight-text">Know exactly how much you can spend today,
                                    guilt-free, while automatically building wealth for your future.</div>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">🔄 How It's Different</h3>
                            <div class="education-section-content">
                                Instead of tracking expenses after you spend, Flow tells you upfront: "Here's your daily
                                amount. Spend it however you want." No guilt, no math, no stress.
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">🎯 Built for Gen Z</h3>
                            <div class="education-section-content">
                                We get it. You want financial freedom without the boomer spreadsheets. Flow uses
                                behavioral psychology to make budgeting feel natural and anxiety-free.
                            </div>
                        </div>
                    </div>

                    <!-- Topic 2: The 3 S's System -->
                    <div class="education-topic-content" id="educationTopicCategories">
                        <div class="education-section">
                            <h3 class="education-section-title">💙 SECURE (55%)</h3>
                            <div class="education-section-content">
                                The foundation. Rent, utilities, groceries, insurance - stuff you literally can't live
                                without. This keeps you stable and secure.
                            </div>

                            <div class="education-example">
                                <div class="education-example-title">SECURE Examples:</div>
                                Rent • Phone bill • Car insurance • Groceries • Minimum debt payments • Utilities
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">💜 SAVE (5-20%)</h3>
                            <div class="education-section-content">
                                Your future self. Emergency fund, retirement, house down payment - wealth that grows
                                automatically and never gets touched.
                            </div>

                            <div class="education-highlight">
                                <div class="education-highlight-title">The Magic of SAVE</div>
                                <div class="education-highlight-text">This money disappears from your mind. You never
                                    see it, never miss it, but it builds your wealth quietly in the background.</div>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">💚 SPEND (25-40%)</h3>
                            <div class="education-section-content">
                                Pure freedom. Coffee, movies, clothes, spontaneous fun - anything that makes life
                                enjoyable. Spend this guilt-free knowing your future is secure.
                            </div>

                            <div class="education-example">
                                <div class="education-example-title">SPEND Examples:</div>
                                Coffee • Dining out • Entertainment • Shopping • Hobbies • Travel • Anything fun
                            </div>
                        </div>
                    </div>

                    <!-- Topic 3: Daily Flow Calculation -->
                    <div class="education-topic-content" id="educationTopicCalculation">
                        <div class="education-section">
                            <h3 class="education-section-title">⚡ The Daily Flow Magic</h3>
                            <div class="education-section-content">
                                We turn your monthly SPEND amount into a daily number that's easy to understand and
                                stick to. Here's exactly how it works:
                            </div>
                        </div>

                        <div class="education-example">
                            <div class="education-example-title">Step-by-Step Calculation</div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">Monthly Income:</span>
                                <span class="education-calculation-value">$3,200</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">SPEND allocation (35%):</span>
                                <span class="education-calculation-value">$1,120</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">+ Built-in buffer:</span>
                                <span class="education-calculation-value">$160</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">Total SPEND amount:</span>
                                <span class="education-calculation-value">$1,280</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">÷ 30 days:</span>
                                <span class="education-calculation-value">$42.67</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">Rounded to nearest $5:</span>
                                <span class="education-calculation-value">$40/day</span>
                            </div>
                        </div>

                        <div class="education-playground">
                            <div class="education-playground-title">🎮 Try It Yourself</div>
                            <input type="number" class="education-playground-input" id="playgroundIncome"
                                placeholder="Enter your monthly income" value="3200"
                                oninput="updatePlaygroundCalculation()">
                            <div class="education-playground-results" id="playgroundResults">
                                <div class="education-playground-result secure">
                                    <div class="education-playground-result-label">SECURE</div>
                                    <div class="education-playground-result-value">$1,760</div>
                                </div>
                                <div class="education-playground-result save">
                                    <div class="education-playground-result-label">SAVE</div>
                                    <div class="education-playground-result-value">$320</div>
                                </div>
                                <div class="education-playground-result spend">
                                    <div class="education-playground-result-label">DAILY FLOW</div>
                                    <div class="education-playground-result-value">$40</div>
                                </div>
                            </div>
                        </div>

                        <div class="education-highlight">
                            <div class="education-highlight-title">Why Round to $5?</div>
                            <div class="education-highlight-text">$42.67 is annoying to remember. $40 is clean, simple,
                                and removes decision fatigue. Small precision loss, huge mental clarity gain.</div>
                        </div>
                    </div>

                    <!-- Topic 4: Smart Allocations -->
                    <div class="education-topic-content" id="educationTopicAllocations">
                        <div class="education-section">
                            <h3 class="education-section-title">🎯 Why You Only Control 2 Categories</h3>
                            <div class="education-section-content">
                                Flow automatically calculates SPEND for you. This isn't lazy design - it's smart
                                psychology that prevents analysis paralysis.
                            </div>
                        </div>

                        <div class="education-example">
                            <div class="education-example-title">The Logic:</div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">SECURE is fixed:</span>
                                <span class="education-calculation-value">55% (life essentials)</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">You choose SAVE:</span>
                                <span class="education-calculation-value">5-20% (wealth building)</span>
                            </div>
                            <div class="education-calculation-step">
                                <span class="education-calculation-label">SPEND auto-adjusts:</span>
                                <span class="education-calculation-value">Whatever's left + buffer</span>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">📈 Profile-Based Starting Points</h3>
                            <div class="education-section-content">
                                We give you smart defaults based on your financial goals, but you can adjust as your
                                life changes.
                            </div>
                        </div>

                        <div class="education-highlight">
                            <div class="education-highlight-title">Starting Out (5% SAVE)</div>
                            <div class="education-highlight-text">New to budgeting? Start small. Build the habit before
                                cranking up the savings rate.</div>
                        </div>

                        <div class="education-highlight">
                            <div class="education-highlight-title">Getting Serious (10% SAVE)</div>
                            <div class="education-highlight-text">Ready for real wealth building. This is the sweet spot
                                for most people.</div>
                        </div>

                        <div class="education-highlight">
                            <div class="education-highlight-title">Building Wealth (20% SAVE)</div>
                            <div class="education-highlight-text">Financial independence mode. You'll hit your goals
                                fast but need discipline.</div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">🔄 When to Adjust</h3>
                            <div class="education-section-content">
                                Major life changes only: new job, big raise, rent increase, debt payoff. Don't tweak
                                monthly - let the system work.
                            </div>
                        </div>
                    </div>

                    <!-- Topic 5: Real Scenarios -->
                    <div class="education-topic-content" id="educationTopicScenarios">
                        <div class="education-section">
                            <h3 class="education-section-title">😰 "What if I overspend?"</h3>
                            <div class="education-section-content">
                                Relax. You have a $160 invisible buffer built into your SPEND amount. This covers
                                unexpected expenses without breaking your system.
                            </div>

                            <div class="education-highlight">
                                <div class="education-highlight-title">The Buffer Psychology</div>
                                <div class="education-highlight-text">You don't see it, but it's there. Like a financial
                                    safety net that prevents anxiety when life happens.</div>
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">😎 "What if I underspend?"</h3>
                            <div class="education-section-content">
                                Even better! Unused amounts roll over to next month, giving you more daily flow or
                                building up for something bigger.
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">🤔 "When do I adjust categories?"</h3>
                            <div class="education-section-content">
                                Only for major life changes: new job, moving, big raise, debt payoff. The system works
                                best when you let it run consistently.
                            </div>
                        </div>

                        <div class="education-section">
                            <h3 class="education-section-title">📊 "How do I know I'm on track?"</h3>
                            <div class="education-section-content">
                                Check your Budget Health tab! Green indicators mean you're crushing it. Yellow means pay
                                attention. Red means adjust something.
                            </div>
                        </div>

                        <div class="education-example">
                            <div class="education-example-title">Real Example: Sarah's Month</div>
                            Week 1: Spent $45/day (slightly over) → Buffer covers it<br>
                            Week 2: Spent $35/day (under budget) → Banking extra<br>
                            Week 3: Friends' birthday dinner ($80 day) → Still within monthly total<br>
                            Week 4: Coasted at $30/day → Ended month ahead
                        </div>

                        <div class="education-highlight">
                            <div class="education-highlight-title">The Flow Mindset</div>
                            <div class="education-highlight-text">It's not about perfect daily amounts. It's about
                                guilt-free spending within a system that automatically builds wealth.</div>
                        </div>
                    </div>
                </div>

                <!-- Progress Indicator -->
                <div class="education-progress-indicator">
                    <div class="education-progress-text" id="educationProgressText">Topic 1 of 5 completed</div>
                    <div class="education-progress-bar">
                        <div class="education-progress-fill" id="educationProgressFill" style="width: 20%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== SETTINGS MODAL SYSTEM (SURGICAL ADDITION) ===== -->
        <div class="settings-modal-overlay" id="settingsModalOverlay">
            <div class="settings-modal-container">
                <!-- Modal Header -->
                <div class="settings-modal-header">
                    <h2 class="settings-modal-title">⚙️ Settings</h2>
                    <p class="settings-modal-subtitle">Customize your Flow experience</p>
                    <button class="settings-close-btn" onclick="closeSettingsModal()">×</button>
                </div>

                <!-- Topic Navigation -->
                <div class="settings-topic-nav">
                    <button class="settings-topic-btn active" onclick="switchSettingsTopic('budget')">💰 Income &
                        Budget</button>
                    <button class="settings-topic-btn" onclick="switchSettingsTopic('notifications')">🔔
                        Notifications</button>
                    <button class="settings-topic-btn" onclick="switchSettingsTopic('data')">📊 Data & Privacy</button>
                </div>

                <!-- Content Container -->
                <div class="settings-content-container">
                    <!-- Tab 1: Income & Budget -->
                    <div class="settings-topic-content active" id="settingsTopicBudget">
                        <!-- Budget Period Control -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">📅 Budget Period</h3>
                            <div class="settings-form-group">
                                <label class="settings-form-label">Choose the period that matches your paycheck
                                    schedule</label>
                                <div class="settings-period-selector">
                                    <div class="settings-period-option active" onclick="selectBudgetPeriod('monthly')">
                                        <div class="settings-period-label">Monthly</div>
                                        <div class="settings-period-amount" id="monthlyAmount">$3,200</div>
                                    </div>
                                    <div class="settings-period-option" onclick="selectBudgetPeriod('biweekly')">
                                        <div class="settings-period-label">Bi-weekly</div>
                                        <div class="settings-period-amount" id="biweeklyAmount">$1,600</div>
                                    </div>
                                    <div class="settings-period-option" onclick="selectBudgetPeriod('weekly')">
                                        <div class="settings-period-label">Weekly</div>
                                        <div class="settings-period-amount" id="weeklyAmount">$800</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Income Management -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">💰 Income Management</h3>
                            <div class="settings-form-group">
                                <label class="settings-form-label" for="settingsIncomeInput"
                                    id="incomeInputLabel">Monthly Income</label>
                                <input type="number" id="settingsIncomeInput" class="settings-form-input"
                                    placeholder="3200" min="500" max="50000" oninput="updateSettingsPreview()">
                            </div>
                            <div class="settings-form-group">
                                <label class="settings-form-label" for="settingsIncomeSource">Income Source</label>
                                <select id="settingsIncomeSource" class="settings-form-select">
                                    <option value="salary">Salary</option>
                                    <option value="freelance">Freelance</option>
                                    <option value="mixed">Mixed</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>

                        <!-- Profile & Allocations -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">🎯 Profile & Allocations</h3>
                            <div class="settings-form-group">
                                <label class="settings-form-label" for="settingsProfile">Financial Profile</label>
                                <select id="settingsProfile" class="settings-form-select"
                                    onchange="updateProfileAllocations()">
                                    <option value="starting">Starting Out (5% SAVE)</option>
                                    <option value="serious" selected>Getting Serious (10% SAVE)</option>
                                    <option value="wealth">Building Wealth (20% SAVE)</option>
                                </select>
                            </div>

                            <div class="settings-slider-group">
                                <div class="settings-slider-header">
                                    <span class="settings-slider-label">💙 SECURE</span>
                                    <span class="settings-slider-value" id="secureSliderValue">55%</span>
                                </div>
                                <input type="range" id="secureSlider" class="settings-slider" min="45" max="65"
                                    value="55" oninput="updateAllocations()">
                            </div>

                            <div class="settings-slider-group">
                                <div class="settings-slider-header">
                                    <span class="settings-slider-label">💜 SAVE</span>
                                    <span class="settings-slider-value" id="saveSliderValue">10%</span>
                                </div>
                                <input type="range" id="saveSlider" class="settings-slider" min="5" max="25" value="10"
                                    oninput="updateAllocations()">
                            </div>

                            <div class="settings-slider-group">
                                <div class="settings-slider-header">
                                    <span class="settings-slider-label">💚 SPEND</span>
                                    <span class="settings-slider-value" id="spendSliderValue">35%</span>
                                </div>
                                <div style="font-size: 12px; color: var(--text-tertiary); margin-top: 4px;">
                                    Auto-calculated to balance your budget
                                </div>
                            </div>

                            <div class="settings-preview-card">
                                <div class="settings-preview-title">Your New Daily Flow</div>
                                <div class="settings-preview-amount" id="settingsPreviewAmount">$40</div>
                                <div class="settings-preview-subtitle" id="settingsPreviewSubtitle">Perfect for
                                    guilt-free daily spending</div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 2: Notifications -->
                    <div class="settings-topic-content" id="settingsTopicNotifications">
                        <div class="settings-section">
                            <h3 class="settings-section-title">🔔 Notification Preferences</h3>
                            <div class="settings-toggle-group">
                                <div class="settings-toggle-item">
                                    <div class="settings-toggle-info">
                                        <div class="settings-toggle-title">Daily Flow Reminders</div>
                                        <div class="settings-toggle-desc">Get notified of your daily spending amount
                                        </div>
                                    </div>
                                    <div class="settings-toggle active" onclick="toggleNotification('dailyFlow', this)">
                                        <div class="settings-toggle-slider"></div>
                                    </div>
                                </div>

                                <div class="settings-toggle-item">
                                    <div class="settings-toggle-info">
                                        <div class="settings-toggle-title">Weekly Budget Check-ins</div>
                                        <div class="settings-toggle-desc">Weekly progress updates and tips</div>
                                    </div>
                                    <div class="settings-toggle active"
                                        onclick="toggleNotification('weeklyCheckin', this)">
                                        <div class="settings-toggle-slider"></div>
                                    </div>
                                </div>

                                <div class="settings-toggle-item">
                                    <div class="settings-toggle-info">
                                        <div class="settings-toggle-title">Achievement Celebrations</div>
                                        <div class="settings-toggle-desc">Get notified when you unlock new badges</div>
                                    </div>
                                    <div class="settings-toggle active"
                                        onclick="toggleNotification('achievements', this)">
                                        <div class="settings-toggle-slider"></div>
                                    </div>
                                </div>

                                <div class="settings-toggle-item">
                                    <div class="settings-toggle-info">
                                        <div class="settings-toggle-title">Overspend Buffer Warnings</div>
                                        <div class="settings-toggle-desc">Alert when approaching your safety buffer
                                        </div>
                                    </div>
                                    <div class="settings-toggle active"
                                        onclick="toggleNotification('bufferWarnings', this)">
                                        <div class="settings-toggle-slider"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 3: Data & Privacy -->
                    <div class="settings-topic-content" id="settingsTopicData">
                        <!-- Export Options -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">📊 Export Data</h3>
                            <button class="settings-action-btn primary" onclick="exportTransactionsCSV()">
                                Download Transactions (CSV)
                            </button>
                            <div style="font-size: 12px; color: var(--text-tertiary); text-align: center;">
                                Export all your transactions for analysis in Excel or Google Sheets
                            </div>
                        </div>

                        <!-- Data Controls -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">🗂️ Data Management</h3>
                            <button class="settings-action-btn secondary" onclick="clearAllTransactions()">
                                Clear All Transactions
                            </button>
                            <button class="settings-action-btn secondary" onclick="resetBudgetDefaults()">
                                Reset Budget to Defaults
                            </button>
                            <button class="settings-action-btn danger" onclick="deleteAllData()">
                                Delete All Data
                            </button>
                        </div>

                        <!-- Privacy Settings -->
                        <div class="settings-section">
                            <h3 class="settings-section-title">🔒 Privacy & Security</h3>
                            <div class="settings-info-card">
                                <div class="settings-info-title">Your Data Stays Local</div>
                                <div class="settings-info-text">
                                    All your financial data is stored locally on your device. We don't collect, store,
                                    or share any of your personal financial information.
                                </div>
                            </div>
                            <div class="settings-info-card">
                                <div class="settings-info-title">No Analytics or Tracking</div>
                                <div class="settings-info-text">
                                    Flow respects your privacy. No usage analytics, no tracking pixels, no third-party
                                    services.
                                </div>
                            </div>
                            <div class="settings-info-card">
                                <div class="settings-info-title">Export Anytime</div>
                                <div class="settings-info-text">
                                    Your data belongs to you. Export your transactions and settings anytime with a
                                    single click.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== CONTEXTUAL TOOLTIP SYSTEM (SURGICAL ADDITION - PHASE 1) ===== -->
        <div class="contextual-tooltip-container" id="contextualTooltipContainer">
            <!-- Dynamic tooltip content will be inserted here -->
        </div>
    </div>

    <script>
        // ===== EXISTING APP STATE & FUNCTIONALITY (PRESERVED) =====
        let appState = {
            currentTab: 'dailyFlow',
            monthlyIncome: 3200,
            allocations: {
                secure: 55,
                save: 10,
                spend: 35
            },
            currentSpending: 175,
            transactions: []
        };

        // ===== JOURNEY TAB STATE MANAGEMENT =====
        let journeyState = {
            currentLevel: 3,
            levelName: 'Building Wealth Warrior',
            totalSaved: 1305,
            nextLevelTarget: 1500,
            streakDays: 12,
            monthlySavings: 500,
            dailyFlow: 40
        };

        // Level system configuration
        const journeyLevels = [
            { name: '🌱 Getting Started', target: 500, avatar: '🌱' },
            { name: '🌿 Building Momentum', target: 1000, avatar: '🌿' },
            { name: '💪 Building Wealth Warrior', target: 1500, avatar: '💪' },
            { name: '🚀 Future Builder', target: 2500, avatar: '🚀' },
            { name: '💎 Wealth Master', target: 5000, avatar: '💎' },
            { name: '🏆 Financial Freedom', target: 10000, avatar: '🏆' }
        ];

        // ===== JOURNEY CALCULATIONS =====
        function updateJourneyCalculations() {
            // Progress to next level
            const currentLevel = journeyLevels[journeyState.currentLevel - 1];
            const nextLevel = journeyLevels[journeyState.currentLevel];
            const progressPercentage = Math.round((journeyState.totalSaved / nextLevel.target) * 100);

            // Future projections
            const sixMonthProjection = journeyState.totalSaved + (journeyState.monthlySavings * 6);
            const oneYearProjection = journeyState.totalSaved + (journeyState.monthlySavings * 12);
            const annualBudget = journeyState.dailyFlow * 365;

            // Update UI elements
            const progressFill = document.getElementById('journeyProgressFill');
            const sixMonthEl = document.getElementById('journeySixMonthProjection');
            const oneYearEl = document.getElementById('journeyOneYearProjection');

            if (progressFill) progressFill.style.width = `${progressPercentage}%`;
            if (sixMonthEl) sixMonthEl.textContent = `$${sixMonthProjection.toLocaleString()}`;
            if (oneYearEl) oneYearEl.textContent = `$${oneYearProjection.toLocaleString()}`;

            console.log('Journey calculations updated', {
                progressPercentage,
                sixMonthProjection,
                oneYearProjection,
                annualBudget
            });
        }

        // ===== JOURNEY TOOLTIP SYSTEM =====
        function showJourneyTooltip(section) {
            let title = '';
            let content = '';

            switch (section) {
                case 'identity':
                    title = '🎯 Your Journey Identity';
                    content = 'This shows your current level, streak, and progress toward the next milestone. Your level represents your financial growth, and your streak shows consistency in tracking your spending.';
                    break;
                case 'timeline':
                    title = '🛤️ Milestone Timeline';
                    content = 'Track your progress through key financial milestones. Each milestone unlocks new features and brings you closer to financial freedom.';
                    break;
                case 'future':
                    title = '🔮 Future Projections';
                    content = 'Based on your current saving habits, this shows where you\'ll be in 6 months and 1 year. These projections help you visualize the power of consistent saving.';
                    break;
            }

            // Simple alert for now - in full implementation this would show a proper tooltip
            alert(`${title}\n\n${content}`);
        }

        // ===== TAB NAVIGATION (EXISTING) =====
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active state from nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');

            // Update nav active state
            event.target.closest('.nav-item').classList.add('active');

            appState.currentTab = tabName;
        }

        // ===== TRANSACTION FUNCTIONALITY (EXISTING) =====
        function quickAdd(amount, description, icon) {
            addTransaction(amount, description, icon);
            updateDisplay();
        }

        function showCustomAddModal() {
            hideContextualTooltip(true); // Hide any active tooltips
            document.getElementById('customAddModal').classList.add('active');
        }

        function closeCustomAddModal() {
            document.getElementById('customAddModal').classList.remove('active');
            // Clear form
            document.getElementById('customAmount').value = '';
            document.getElementById('customDescription').value = '';
            document.getElementById('customCategory').selectedIndex = 0;
        }

        function addCustomExpense() {
            const amount = parseFloat(document.getElementById('customAmount').value);
            const description = document.getElementById('customDescription').value;
            const category = document.getElementById('customCategory').value;

            if (amount && description) {
                const icon = getCategoryIcon(category);
                addTransaction(amount, description, icon, category);
                closeCustomAddModal();
                updateDisplay();
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                food: '🍽️',
                entertainment: '🎬',
                shopping: '🛒',
                transport: '🚗',
                health: '🏥',
                education: '📚',
                other: '✨'
            };
            return icons[category] || '💳';
        }

        function addTransaction(amount, description, icon, category = '') {
            const transaction = {
                id: Date.now(),
                amount: amount,
                description: description,
                icon: icon,
                category: category,
                timestamp: new Date(),
                type: 'expense'
            };

            appState.transactions.unshift(transaction);
            appState.currentSpending += amount;

            // Keep only last 10 transactions for display
            if (appState.transactions.length > 10) {
                appState.transactions = appState.transactions.slice(0, 10);
            }
        }

        function editTransaction(id) {
            const transaction = appState.transactions.find(t => t.id === id);
            if (!transaction) return;

            // Pre-fill the custom add modal with transaction data
            document.getElementById('customAmount').value = transaction.amount;
            document.getElementById('customDescription').value = transaction.description;
            document.getElementById('customCategory').value = transaction.category || 'other';
            
            // Remove the old transaction
            deleteTransaction(id);
            
            // Show modal for editing
            showCustomAddModal();
        }

        function deleteTransaction(id) {
            const transactionIndex = appState.transactions.findIndex(t => t.id === id);
            if (transactionIndex === -1) return;

            const transaction = appState.transactions[transactionIndex];
            
            // Remove from spending total
            appState.currentSpending = Math.max(0, appState.currentSpending - transaction.amount);
            
            // Remove from transactions array
            appState.transactions.splice(transactionIndex, 1);
            
            // Update all displays
            updateAllDisplays();
            saveData();
            
            // Show feedback
            showCelebration('🗑️', `Deleted ${transaction.description}`);
        }

        function updateDisplay() {
            updateDailyFlowDisplay();
            updateProgressBar();
            updateRecentTransactions();
            updateBudgetHealthDisplay();
        }

        function updateDailyFlowDisplay() {
            const income = appState.monthlyIncome;
            const spendAllocation = appState.allocations.spend;
            const spendAmount = Math.round(income * (spendAllocation / 100) / 5) * 5 + 160; // Enhanced SPEND with buffer
            const dailyFlow = Math.round(spendAmount / 30 / 5) * 5;

            document.getElementById('dailyFlowAmount').textContent = `$${dailyFlow}`;

            // Update context based on spending pace
            const daysInMonth = 30;
            const currentDay = 15; // Example current day
            const expectedSpending = (dailyFlow * currentDay);
            const actualSpending = appState.currentSpending;

            let context = "Perfect pace to stay on track";
            if (actualSpending > expectedSpending * 1.1) {
                context = "Slightly ahead of pace - watch spending";
            } else if (actualSpending < expectedSpending * 0.8) {
                context = "Under budget - you're doing great!";
            }

            document.getElementById('dailyFlowContext').textContent = context;
        }

        function updateProgressBar() {
            const income = appState.monthlyIncome;
            const spendAllocation = appState.allocations.spend;
            const totalSpendBudget = Math.round(income * (spendAllocation / 100) / 5) * 5 + 160;
            const currentSpending = appState.currentSpending;
            const progressPercentage = Math.min((currentSpending / totalSpendBudget) * 100, 100);

            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
            document.getElementById('progressAmount').textContent =
                `$${currentSpending} of $${totalSpendBudget} spent`;
        }

        function updateRecentTransactions() {
            const transactionsList = document.getElementById('recentTransactionsList');

            if (appState.transactions.length === 0) {
                transactionsList.innerHTML = `
                    <div style="text-align: center; color: var(--text-muted); padding: 20px;">
                        No transactions yet. Add your first expense above!
                    </div>
                `;
                return;
            }

            transactionsList.innerHTML = appState.transactions.map(transaction => {
                const categoryIcon = transaction.category === 'SECURE' ? '🛡️' : 
                                   transaction.category === 'SAVE' ? '💰' : '💚';
                const categoryColor = transaction.category === 'SECURE' ? 'var(--accent-blue)' : 
                                    transaction.category === 'SAVE' ? 'var(--accent-purple)' : 'var(--accent-green)';
                
                return `
                <div class="transaction-item" data-transaction-id="${transaction.id}">
                    <div class="transaction-icon">${transaction.icon}</div>
                    <div class="transaction-details">
                        <div class="transaction-description">${transaction.description}</div>
                        <div class="transaction-category">Today • ${transaction.category || 'SPEND'}</div>
                    </div>
                    <div class="transaction-actions">
                        <div class="transaction-amount" style="color: ${categoryColor}">$${transaction.amount}<span class="category-icon">${categoryIcon}</span></div>
                        <div class="transaction-buttons">
                            <button class="transaction-btn edit" onclick="editTransaction(${transaction.id})" aria-label="Edit">✏️</button>
                            <button class="transaction-btn delete" onclick="deleteTransaction(${transaction.id})" aria-label="Delete">🗑️</button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        function updateBudgetHealthDisplay() {
            const income = appState.monthlyIncome;
            const allocations = appState.allocations;

            // Calculate amounts
            const secureAmount = Math.round(income * (allocations.secure / 100) / 5) * 5;
            const saveAmount = Math.round(income * (allocations.save / 100) / 5) * 5;
            const spendAmount = Math.round(income * (allocations.spend / 100) / 5) * 5 + 160;

            // Update display amounts
            document.getElementById('secureAmount').textContent = `$${secureAmount.toLocaleString()}`;
            document.getElementById('saveAmount').textContent = `$${saveAmount.toLocaleString()}`;
            document.getElementById('spendAmount').textContent = `$${spendAmount.toLocaleString()}`;

            // Update SPEND progress (based on current spending)
            const spendProgress = Math.min((appState.currentSpending / spendAmount) * 100, 100);
            document.getElementById('spendProgressFill').style.width = `${spendProgress}%`;
            document.getElementById('spendCurrentMonth').textContent = `$${appState.currentSpending}`;
            document.getElementById('spendRemaining').textContent = `$${spendAmount - appState.currentSpending}`;
        }

        // ===== SETTINGS MODAL SYSTEM (SURGICAL ADDITION) =====
        let settingsState = {
            currentTopic: 'budget',
            isVisible: false,
            budgetPeriod: 'monthly',
            pendingChanges: {},
            notifications: {
                dailyFlow: true,
                weeklyCheckin: true,
                achievements: true,
                bufferWarnings: true
            }
        };

        function showSettings() {
            hideContextualTooltip(true); // Hide any active tooltips

            // Load current app settings into settings modal
            loadCurrentSettingsIntoModal();

            document.getElementById('settingsModalOverlay').classList.add('active');
            settingsState.isVisible = true;

            console.log('Settings modal opened');
        }

        function closeSettingsModal() {
            document.getElementById('settingsModalOverlay').classList.remove('active');
            settingsState.isVisible = false;

            console.log('Settings modal closed');
        }

        function switchSettingsTopic(topicName) {
            // Hide all topic content
            document.querySelectorAll('.settings-topic-content').forEach(content => {
                content.classList.remove('active');
            });

            // Remove active state from nav buttons
            document.querySelectorAll('.settings-topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected topic
            document.getElementById(`settingsTopic${capitalizeFirst(topicName)}`).classList.add('active');

            // Update nav active state
            event.target.classList.add('active');

            // Update state
            settingsState.currentTopic = topicName;

            console.log(`Switched to settings topic: ${topicName}`);
        }

        function loadCurrentSettingsIntoModal() {
            // Load current app state into settings form
            const income = appState.monthlyIncome || 3200;
            const allocations = appState.allocations || { secure: 55, save: 10, spend: 35 };

            // Set income input
            document.getElementById('settingsIncomeInput').value = income;

            // Set allocation sliders
            document.getElementById('secureSlider').value = allocations.secure;
            document.getElementById('saveSlider').value = allocations.save;

            // Set profile selector based on save percentage
            const profileSelect = document.getElementById('settingsProfile');
            if (allocations.save <= 5) {
                profileSelect.value = 'starting';
            } else if (allocations.save <= 15) {
                profileSelect.value = 'serious';
            } else {
                profileSelect.value = 'wealth';
            }

            // Update slider value displays
            document.getElementById('secureSliderValue').textContent = `${allocations.secure}%`;
            document.getElementById('saveSliderValue').textContent = `${allocations.save}%`;
            document.getElementById('spendSliderValue').textContent = `${allocations.spend}%`;

            // Update period amounts
            updatePeriodAmounts(income);

            // Update preview
            updateSettingsPreview();

            // Load saved notification preferences
            try {
                const savedNotifications = localStorage.getItem('flowNotificationSettings');
                if (savedNotifications) {
                    const notifications = JSON.parse(savedNotifications);
                    settingsState.notifications = { ...settingsState.notifications, ...notifications };

                    // Update UI toggles
                    Object.entries(notifications).forEach(([key, value]) => {
                        const toggles = document.querySelectorAll(`[onclick*="${key}"]`);
                        toggles.forEach(toggle => {
                            if (value) {
                                toggle.classList.add('active');
                            } else {
                                toggle.classList.remove('active');
                            }
                        });
                    });
                }
            } catch (error) {
                console.warn('Could not load notification settings:', error);
            }
        }

        function selectBudgetPeriod(period) {
            // Remove active class from all period options
            document.querySelectorAll('.settings-period-option').forEach(option => {
                option.classList.remove('active');
            });

            // Add active class to selected option
            event.target.closest('.settings-period-option').classList.add('active');

            settingsState.budgetPeriod = period;

            // Update income input label and validation
            const incomeInput = document.getElementById('settingsIncomeInput');
            const incomeLabel = document.getElementById('incomeInputLabel');

            switch (period) {
                case 'monthly':
                    incomeLabel.textContent = 'Monthly Income';
                    incomeInput.min = 500;
                    incomeInput.max = 50000;
                    incomeInput.placeholder = '3200';
                    break;
                case 'biweekly':
                    incomeLabel.textContent = 'Bi-weekly Income';
                    incomeInput.min = 250;
                    incomeInput.max = 25000;
                    incomeInput.placeholder = '1600';
                    break;
                case 'weekly':
                    incomeLabel.textContent = 'Weekly Income';
                    incomeInput.min = 125;
                    incomeInput.max = 12500;
                    incomeInput.placeholder = '800';
                    break;
            }

            // Convert current income to selected period
            const currentIncome = parseFloat(incomeInput.value) || 3200;
            let convertedIncome;

            if (period === 'biweekly') {
                convertedIncome = Math.round(currentIncome / 2);
            } else if (period === 'weekly') {
                convertedIncome = Math.round(currentIncome / 4);
            } else {
                convertedIncome = currentIncome;
            }

            incomeInput.value = convertedIncome;
            updateSettingsPreview();

            console.log(`Budget period changed to: ${period}`);
        }

        function updatePeriodAmounts(monthlyIncome) {
            const income = monthlyIncome || 3200;

            document.getElementById('monthlyAmount').textContent = `${income.toLocaleString()}`;
            document.getElementById('biweeklyAmount').textContent = `${Math.round(income / 2).toLocaleString()}`;
            document.getElementById('weeklyAmount').textContent = `${Math.round(income / 4).toLocaleString()}`;
        }

        function updateProfileAllocations() {
            const profile = document.getElementById('settingsProfile').value;

            // Set allocation defaults based on profile
            let savePercentage;
            switch (profile) {
                case 'starting':
                    savePercentage = 5;
                    break;
                case 'serious':
                    savePercentage = 10;
                    break;
                case 'wealth':
                    savePercentage = 20;
                    break;
            }

            // Update save slider
            document.getElementById('saveSlider').value = savePercentage;

            // Update allocations
            updateAllocations();

            console.log(`Profile changed to: ${profile}`);
        }

        function updateAllocations() {
            const secureValue = parseInt(document.getElementById('secureSlider').value);
            const saveValue = parseInt(document.getElementById('saveSlider').value);
            const spendValue = 100 - secureValue - saveValue;

            // Update slider value displays
            document.getElementById('secureSliderValue').textContent = `${secureValue}%`;
            document.getElementById('saveSliderValue').textContent = `${saveValue}%`;
            document.getElementById('spendSliderValue').textContent = `${spendValue}%`;

            // Store pending changes
            settingsState.pendingChanges.allocations = {
                secure: secureValue,
                save: saveValue,
                spend: spendValue
            };

            updateSettingsPreview();
        }

        function updateSettingsPreview() {
            const income = parseFloat(document.getElementById('settingsIncomeInput').value) || 3200;
            const securePercent = parseInt(document.getElementById('secureSlider').value) || 55;
            const savePercent = parseInt(document.getElementById('saveSlider').value) || 10;
            const spendPercent = 100 - securePercent - savePercent;

            // Calculate based on current period
            let monthlyIncome = income;
            if (settingsState.budgetPeriod === 'biweekly') {
                monthlyIncome = income * 2;
            } else if (settingsState.budgetPeriod === 'weekly') {
                monthlyIncome = income * 4;
            }

            // Calculate SPEND amount with buffer
            const spendAmount = Math.round(monthlyIncome * (spendPercent / 100) / 5) * 5 + 160;
            const dailyFlow = Math.round(spendAmount / 30 / 5) * 5;

            // Update preview display
            document.getElementById('settingsPreviewAmount').textContent = `${dailyFlow}`;

            // Update period amounts in selector
            updatePeriodAmounts(monthlyIncome);

            // Store pending changes
            settingsState.pendingChanges.income = monthlyIncome;
            settingsState.pendingChanges.budgetPeriod = settingsState.budgetPeriod;
        }

        function toggleNotification(type, toggleElement) {
            const isActive = toggleElement.classList.contains('active');

            if (isActive) {
                toggleElement.classList.remove('active');
                settingsState.notifications[type] = false;
            } else {
                toggleElement.classList.add('active');
                settingsState.notifications[type] = true;
            }

            // Save notification preferences
            try {
                localStorage.setItem('flowNotificationSettings', JSON.stringify(settingsState.notifications));
            } catch (error) {
                console.warn('Could not save notification settings:', error);
            }

            console.log(`Notification ${type} toggled to: ${settingsState.notifications[type]}`);
        }

        function exportTransactionsCSV() {
            const transactions = appState.transactions || [];

            if (transactions.length === 0) {
                alert('No transactions to export. Add some expenses first!');
                return;
            }

            // Create CSV content
            const csvHeaders = ['Date', 'Description', 'Amount', 'Category', 'Type'];
            const csvRows = transactions.map(transaction => [
                new Date(transaction.timestamp).toLocaleDateString(),
                `"${transaction.description}"`,
                transaction.amount,
                transaction.category || 'General',
                transaction.type || 'expense'
            ]);

            const csvContent = [
                csvHeaders.join(','),
                ...csvRows.map(row => row.join(','))
            ].join('\n');

            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');

            link.href = url;
            link.download = `flow-transactions-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();

            URL.revokeObjectURL(url);

            console.log('Transactions exported to CSV');
            alert('✅ Transactions exported successfully!');
        }

        function clearAllTransactions() {
            if (confirm('Are you sure you want to clear all transactions? This cannot be undone.')) {
                appState.transactions = [];
                appState.currentSpending = 0;

                // Save to localStorage
                try {
                    localStorage.setItem('flowAppData', JSON.stringify(appState));
                } catch (error) {
                    console.warn('Could not save data:', error);
                }

                // Update display
                updateDisplay();

                console.log('All transactions cleared');
                alert('✅ All transactions have been cleared.');
            }
        }

        function resetBudgetDefaults() {
            if (confirm('Reset your budget to default settings? This will change your income to $3,200 and allocations to Starting Out profile.')) {
                // Reset to defaults
                appState.monthlyIncome = 3200;
                appState.allocations = { secure: 55, save: 5, spend: 40 };

                // Update settings modal
                loadCurrentSettingsIntoModal();

                // Save to localStorage
                try {
                    localStorage.setItem('flowAppData', JSON.stringify(appState));
                } catch (error) {
                    console.warn('Could not save data:', error);
                }

                // Update display
                updateDisplay();

                console.log('Budget reset to defaults');
                alert('✅ Budget reset to default settings.');
            }
        }

        function deleteAllData() {
            if (confirm('⚠️ WARNING: This will permanently delete ALL your data including transactions, settings, and progress. This cannot be undone.\n\nType "DELETE" to confirm.')) {
                const confirmation = prompt('Type "DELETE" to confirm:');
                if (confirmation === 'DELETE') {
                    // Clear all localStorage
                    try {
                        localStorage.removeItem('flowAppData');
                        localStorage.removeItem('flowEducationProgress');
                        localStorage.removeItem('flowNotificationSettings');
                        localStorage.removeItem('flowContextualHelp');
                    } catch (error) {
                        console.warn('Could not clear localStorage:', error);
                    }

                    // Reset app state
                    appState = {
                        currentTab: 'dailyFlow',
                        monthlyIncome: 3200,
                        allocations: { secure: 55, save: 10, spend: 35 },
                        currentSpending: 0,
                        transactions: []
                    };

                    // Reset settings state
                    settingsState.notifications = {
                        dailyFlow: true,
                        weeklyCheckin: true,
                        achievements: true,
                        bufferWarnings: true
                    };

                    // Close modal and update display
                    closeSettingsModal();
                    updateDisplay();

                    console.log('All data deleted');
                    alert('🗑️ All data has been permanently deleted.');
                } else {
                    alert('Deletion cancelled - confirmation text did not match.');
                }
            }
        }

        // ===== SETTINGS MODAL SYSTEM (SURGICAL ADDITION) =====

        function showAllTransactions() {
            alert('Full transaction history coming soon! 📋\n\nWill include:\n• Complete transaction list\n• Category filtering\n• Search functionality\n• Export options');
        }

        // ===== EDUCATION MODAL SYSTEM (SURGICAL ADDITION) =====
        let educationState = {
            currentTopic: 'overview',
            completedTopics: new Set(),
            isVisible: false
        };

        function showEducationHub() {
            hideContextualTooltip(true); // Hide any active tooltips
            document.getElementById('educationModalOverlay').classList.add('active');
            educationState.isVisible = true;
            educationState.completedTopics.add('overview'); // Mark first topic as viewed
            updateEducationProgress();

            // Track engagement
            trackEducationEvent('modal_opened');
        }

        function closeEducationModal() {
            document.getElementById('educationModalOverlay').classList.remove('active');
            educationState.isVisible = false;

            // Save progress to localStorage
            try {
                localStorage.setItem('flowEducationProgress', JSON.stringify({
                    completedTopics: Array.from(educationState.completedTopics),
                    lastVisited: new Date().toISOString()
                }));
            } catch (error) {
                console.warn('Unable to save education progress:', error);
            }

            trackEducationEvent('modal_closed');
        }

        function switchEducationTopic(topicName) {
            // Hide all topic content
            document.querySelectorAll('.education-topic-content').forEach(content => {
                content.classList.remove('active');
            });

            // Remove active state from nav buttons
            document.querySelectorAll('.education-topic-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected topic
            document.getElementById(`educationTopic${capitalizeFirst(topicName)}`).classList.add('active');

            // Update nav active state
            event.target.classList.add('active');

            // Update state
            educationState.currentTopic = topicName;
            educationState.completedTopics.add(topicName);

            updateEducationProgress();
            trackEducationEvent('topic_viewed', topicName);
        }

        function updateEducationProgress() {
            const totalTopics = 5;
            const completedCount = educationState.completedTopics.size;
            const progressPercentage = (completedCount / totalTopics) * 100;

            document.getElementById('educationProgressFill').style.width = `${progressPercentage}%`;
            document.getElementById('educationProgressText').textContent =
                `Topic ${completedCount} of ${totalTopics} completed`;
        }

        function updatePlaygroundCalculation() {
            const income = parseFloat(document.getElementById('playgroundIncome').value) || 0;

            if (income < 100) return; // Prevent calculation for very small inputs

            // Use current app allocations
            const allocations = appState.allocations;

            const secureAmount = Math.round(income * (allocations.secure / 100) / 5) * 5;
            const saveAmount = Math.round(income * (allocations.save / 100) / 5) * 5;
            const spendAmount = Math.round(income * (allocations.spend / 100) / 5) * 5 + 160;
            const dailyFlow = Math.round(spendAmount / 30 / 5) * 5;

            // Update playground results
            const results = document.querySelectorAll('.education-playground-result-value');
            results[0].textContent = `$${secureAmount.toLocaleString()}`;
            results[1].textContent = `$${saveAmount.toLocaleString()}`;
            results[2].textContent = `$${dailyFlow}`;
        }

        function trackEducationEvent(eventType, details = '') {
            // Track completion metrics as requested
            const eventData = {
                type: eventType,
                topic: educationState.currentTopic,
                details: details,
                timestamp: new Date().toISOString(),
                completedTopics: Array.from(educationState.completedTopics)
            };

            console.log('Education Event:', eventData);

            // In production, this would send to analytics
            // analytics.track('education_interaction', eventData);
        }

        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Load education progress from localStorage on startup
        function loadEducationProgress() {
            try {
                const saved = localStorage.getItem('flowEducationProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    educationState.completedTopics = new Set(progress.completedTopics || []);
                }
            } catch (error) {
                console.warn('Unable to load education progress:', error);
            }
        }

        // ===== CONTEXTUAL TOOLTIP SYSTEM (SURGICAL ADDITION - PHASE 1) =====
        let tooltipState = {
            currentTooltip: null,
            showDelay: 500,
            hideDelay: 100,
            showTimer: null,
            hideTimer: null
        };

        const tooltipDefinitions = {
            dailyFlowAmount: {
                title: "💡 Daily Flow Calculation",
                content: "This amount comes from your monthly SPEND allocation divided by 30 days",
                action: "Tap 📚 Education for full breakdown"
            },
            healthIndicator: {
                title: "💚 Health Status",
                content: "Excellent Health means you're using 80% or less of this category's budget",
                action: null
            },
            quickAddButton: {
                title: "🎯 From Your Daily Flow",
                content: "This expense comes directly from your daily SPEND allocation",
                action: "Track in real-time as you spend"
            },
            allocationPercentage: {
                title: "🔄 Smart Allocation",
                content: "SPEND adjusts automatically when you change SECURE or SAVE percentages",
                action: "Only SECURE and SAVE can be manually adjusted"
            },
            progressBar: {
                title: "📊 Monthly Progress",
                content: "Visual tracking of how much you've used vs. your monthly allocation",
                action: "Green zone = on track, Red zone = time to slow down"
            },
            achievementBadge: {
                title: "🏆 Achievement Earned",
                content: "Unlocked by consistent spending habits and hitting your flow targets",
                action: "Keep up the great work!"
            },
            categoryCard: {
                title: "📚 Learn More",
                content: "Each category serves a specific purpose in your financial flow",
                action: "Tap the 📚 icon above for complete explanation"
            }
        };

        function showContextualTooltip(elementSelectorOrElement, tooltipType, customContent = null) {
            // Clear any existing timers
            clearTimeout(tooltipState.showTimer);
            clearTimeout(tooltipState.hideTimer);

            // Hide current tooltip if exists
            if (tooltipState.currentTooltip) {
                hideContextualTooltip(true);
            }

            tooltipState.showTimer = setTimeout(() => {
                // Handle both selector strings and DOM elements
                const triggerElement = typeof elementSelectorOrElement === 'string'
                    ? document.querySelector(elementSelectorOrElement)
                    : elementSelectorOrElement;
                if (!triggerElement) return;

                const tooltipContainer = document.getElementById('contextualTooltipContainer');
                const tooltipData = customContent || tooltipDefinitions[tooltipType];

                if (!tooltipData) return;

                // Create tooltip element
                const tooltip = document.createElement('div');
                tooltip.className = 'contextual-tooltip';
                tooltip.innerHTML = `
                    <div class="contextual-tooltip-header">${tooltipData.title}</div>
                    <div class="contextual-tooltip-content">${tooltipData.content}</div>
                    ${tooltipData.action ? `<div class="contextual-tooltip-action">${tooltipData.action}</div>` : ''}
                    <div class="contextual-tooltip-arrow"></div>
                `;

                tooltipContainer.appendChild(tooltip);
                tooltipState.currentTooltip = tooltip;

                // Position tooltip
                positionTooltip(tooltip, triggerElement);

                // Show tooltip
                requestAnimationFrame(() => {
                    tooltip.classList.add('active');
                });

                // Auto-hide after 5 seconds
                tooltipState.hideTimer = setTimeout(() => {
                    hideContextualTooltip();
                }, 5000);
            }, tooltipState.showDelay);
        }

        function hideContextualTooltip(immediate = false) {
            clearTimeout(tooltipState.showTimer);
            clearTimeout(tooltipState.hideTimer);

            if (!tooltipState.currentTooltip) return;

            const tooltip = tooltipState.currentTooltip;

            if (immediate) {
                tooltip.remove();
                tooltipState.currentTooltip = null;
            } else {
                tooltip.classList.remove('active');
                setTimeout(() => {
                    if (tooltip.parentNode) {
                        tooltip.remove();
                    }
                    if (tooltipState.currentTooltip === tooltip) {
                        tooltipState.currentTooltip = null;
                    }
                }, 300);
            }
        }

        function positionTooltip(tooltip, triggerElement) {
            const triggerRect = triggerElement.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            const arrow = tooltip.querySelector('.contextual-tooltip-arrow');

            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const margin = 12;

            let left, top, arrowClass;

            // Try positioning below first
            if (triggerRect.bottom + tooltipRect.height + margin < viewportHeight) {
                top = triggerRect.bottom + margin;
                left = triggerRect.left + (triggerRect.width / 2) - (tooltipRect.width / 2);
                arrowClass = 'top';
            }
            // Try positioning above
            else if (triggerRect.top - tooltipRect.height - margin > 0) {
                top = triggerRect.top - tooltipRect.height - margin;
                left = triggerRect.left + (triggerRect.width / 2) - (tooltipRect.width / 2);
                arrowClass = 'bottom';
            }
            // Try positioning to the right
            else if (triggerRect.right + tooltipRect.width + margin < viewportWidth) {
                left = triggerRect.right + margin;
                top = triggerRect.top + (triggerRect.height / 2) - (tooltipRect.height / 2);
                arrowClass = 'left';
            }
            // Position to the left
            else {
                left = triggerRect.left - tooltipRect.width - margin;
                top = triggerRect.top + (triggerRect.height / 2) - (tooltipRect.height / 2);
                arrowClass = 'right';
            }

            // Ensure tooltip stays within viewport
            left = Math.max(margin, Math.min(left, viewportWidth - tooltipRect.width - margin));
            top = Math.max(margin, Math.min(top, viewportHeight - tooltipRect.height - margin));

            tooltip.style.left = `${left}px`;
            tooltip.style.top = `${top}px`;
            arrow.className = `contextual-tooltip-arrow ${arrowClass}`;
        }

        function initializeContextualTooltips() {
            // Daily Flow Amount tooltip
            const dailyFlowAmount = document.getElementById('dailyFlowAmount');
            if (dailyFlowAmount) {
                dailyFlowAmount.addEventListener('mouseenter', () => {
                    showContextualTooltip('#dailyFlowAmount', 'dailyFlowAmount');
                });
                dailyFlowAmount.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
                dailyFlowAmount.addEventListener('click', () => {
                    showEducationHub();
                    hideContextualTooltip(true);
                });
            }

            // Health Indicators tooltips
            const healthIndicators = document.querySelectorAll('.health-icon');
            healthIndicators.forEach((indicator, index) => {
                indicator.addEventListener('mouseenter', () => {
                    const categoryNames = ['SECURE', 'SAVE', 'SPEND'];
                    const categoryName = categoryNames[index] || 'Category';
                    const customContent = {
                        title: "💚 Health Status",
                        content: `${categoryName} category is in excellent health - you're staying within budget`,
                        action: "Green = Great, Yellow = Caution, Red = Attention needed"
                    };
                    showContextualTooltip(indicator, 'healthIndicator', customContent);
                });
                indicator.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
            });

            // Quick Add Buttons tooltips (exclude Custom Add button)
            const quickAddButtons = document.querySelectorAll('.quick-action');
            quickAddButtons.forEach((button, index) => {
                // Skip the last button (Custom Add)
                if (index === quickAddButtons.length - 1) return;

                button.addEventListener('mouseenter', () => {
                    const amountElement = button.querySelector('.quick-action-amount');
                    const labelElement = button.querySelector('.quick-action-label');
                    if (amountElement && labelElement) {
                        const amount = amountElement.textContent;
                        const label = labelElement.textContent;
                        const customContent = {
                            title: "🎯 From Your Daily Flow",
                            content: `This ${amount} ${label} expense comes from your daily SPEND allocation`,
                            action: "Tracked in real-time - no guilt needed!"
                        };
                        showContextualTooltip(button, 'quickAddButton', customContent);
                    }
                });
                button.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
            });

            // Allocation Percentage tooltips
            const allocationPercentages = document.querySelectorAll('.budget-percentage');
            allocationPercentages.forEach(percentage => {
                percentage.addEventListener('mouseenter', () => {
                    const isSpend = percentage.closest('.budget-card').classList.contains('spend');
                    const customContent = {
                        title: "🔄 Smart Allocation",
                        content: isSpend ?
                            "SPEND adjusts automatically when you change SECURE or SAVE" :
                            "You can adjust this percentage - SPEND will auto-adjust to balance",
                        action: isSpend ? "Only SECURE and SAVE can be manually edited" : "Changes affect your daily flow amount"
                    };
                    showContextualTooltip(percentage, 'allocationPercentage', customContent);
                });
                percentage.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
            });

            // Progress Bars tooltips
            const progressBars = document.querySelectorAll('.category-progress-bar');
            progressBars.forEach(progressBar => {
                progressBar.addEventListener('mouseenter', () => {
                    const card = progressBar.closest('.budget-card');
                    const categoryClass = card.classList[1];
                    const usedElement = card.querySelector(`.${categoryClass}-used, .${categoryClass}-current`);
                    const totalElement = card.querySelector(`#${categoryClass}Amount`);

                    if (usedElement && totalElement) {
                        const used = usedElement.textContent;
                        const total = totalElement.textContent;
                        const customContent = {
                            title: "📊 Monthly Progress",
                            content: `You've used ${used} of ${total} this month - excellent pace!`,
                            action: "Green zone = on track, Red zone = slow down"
                        };
                        showContextualTooltip(progressBar, 'progressBar', customContent);
                    }
                });
                progressBar.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
            });

            // Achievement Badges tooltips
            const achievementBadges = document.querySelectorAll('.badge-container');
            achievementBadges.forEach(badge => {
                badge.addEventListener('mouseenter', () => {
                    const badgeText = badge.querySelector('.badge-text').textContent;
                    const customContent = {
                        title: "🏆 Achievement Earned",
                        content: `${badgeText} - unlocked by consistent spending habits`,
                        action: "Keep building healthy financial habits!"
                    };
                    showContextualTooltip(badge, 'achievementBadge', customContent);
                });
                badge.addEventListener('mouseleave', () => {
                    hideContextualTooltip();
                });
            });

            // Category Cards tooltips
            const categoryCards = document.querySelectorAll('.budget-card');
            categoryCards.forEach(card => {
                const cardTitle = card.querySelector('.budget-title');
                if (cardTitle) {
                    cardTitle.addEventListener('mouseenter', () => {
                        const categoryName = cardTitle.textContent.trim();
                        const customContent = {
                            title: "📚 Learn More",
                            content: `${categoryName} serves a specific purpose in your financial flow`,
                            action: "Tap the 📚 Education icon for complete explanation"
                        };
                        showContextualTooltip(cardTitle, 'categoryCard', customContent);
                    });
                    cardTitle.addEventListener('mouseleave', () => {
                        hideContextualTooltip();
                    });
                    cardTitle.addEventListener('click', () => {
                        showEducationHub();
                        hideContextualTooltip(true);
                    });
                }
            });

            // Mobile touch support
            if ('ontouchstart' in window) {
                // Add tap-and-hold for mobile tooltips
                let touchTimer;

                const touchElements = [dailyFlowAmount, ...Array.from(healthIndicators), ...Array.from(quickAddButtons), ...Array.from(allocationPercentages), ...Array.from(progressBars), ...Array.from(achievementBadges)];

                touchElements.forEach(element => {
                    if (!element) return;

                    element.addEventListener('touchstart', (e) => {
                        touchTimer = setTimeout(() => {
                            // Trigger appropriate tooltip based on element
                            if (element === dailyFlowAmount) {
                                showContextualTooltip('#dailyFlowAmount', 'dailyFlowAmount');
                            } else if (healthIndicators && Array.from(healthIndicators).includes(element)) {
                                const customContent = {
                                    title: "💚 Health Status",
                                    content: "This category is in excellent health - you're staying within budget",
                                    action: "Green = Great, Yellow = Caution, Red = Attention needed"
                                };
                                showContextualTooltip(element, 'healthIndicator', customContent);
                            }
                            // Add more mobile-specific handlers as needed
                        }, 800); // Long press duration
                    });

                    element.addEventListener('touchend', () => {
                        clearTimeout(touchTimer);
                    });

                    element.addEventListener('touchmove', () => {
                        clearTimeout(touchTimer);
                    });
                });
            }

            console.log('✅ Contextual tooltips initialized - 7 interactive help points active (errors fixed)');
        }

        // ===== APP INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function () {
            updateDisplay();
            loadEducationProgress();
            initializeContextualTooltips();
            updateJourneyCalculations();

            // Initial playground calculation
            updatePlaygroundCalculation();

            console.log('🎯 Flow App v3.3 - Enhanced Journey Experience Loaded');
            console.log('✅ All 4 journey components implemented with surgical precision');
        });

        // Close modals when clicking outside
        document.addEventListener('click', function (event) {
            // Custom Add Modal
            if (event.target.classList.contains('modal-overlay')) {
                closeCustomAddModal();
            }

            // Education Modal
            if (event.target.classList.contains('education-modal-overlay')) {
                closeEducationModal();
            }

            // Settings Modal
            if (event.target.classList.contains('settings-modal-overlay')) {
                closeSettingsModal();
            }

            // Hide tooltips when clicking outside
            if (!event.target.closest('.contextual-tooltip') && !event.target.closest('.contextual-tooltip-trigger')) {
                hideContextualTooltip();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                closeCustomAddModal();
                closeEducationModal();
                closeSettingsModal();
                hideContextualTooltip(true);
            }
        });
    </script>
</body>

</html>